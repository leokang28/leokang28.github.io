<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Chapter 8 - Generic Types, Traits, and Lifetimes | KSLEO</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="Just playing around">
    <link rel="preload" href="/assets/css/0.styles.35aebc44.css" as="style"><link rel="preload" href="/assets/js/app.6f46cf57.js" as="script"><link rel="preload" href="/assets/js/2.49ce1412.js" as="script"><link rel="preload" href="/assets/js/13.beaf8085.js" as="script"><link rel="prefetch" href="/assets/js/10.86ad4e85.js"><link rel="prefetch" href="/assets/js/11.e7ef91a0.js"><link rel="prefetch" href="/assets/js/12.14d347b9.js"><link rel="prefetch" href="/assets/js/14.e42e08a4.js"><link rel="prefetch" href="/assets/js/15.41e8c95f.js"><link rel="prefetch" href="/assets/js/16.e8b84c5d.js"><link rel="prefetch" href="/assets/js/17.4d574f20.js"><link rel="prefetch" href="/assets/js/18.a8a8e164.js"><link rel="prefetch" href="/assets/js/19.118b3a66.js"><link rel="prefetch" href="/assets/js/20.ccdc0717.js"><link rel="prefetch" href="/assets/js/21.88ceead5.js"><link rel="prefetch" href="/assets/js/22.500d3be7.js"><link rel="prefetch" href="/assets/js/23.b7ca339b.js"><link rel="prefetch" href="/assets/js/24.0360313a.js"><link rel="prefetch" href="/assets/js/25.6083b636.js"><link rel="prefetch" href="/assets/js/26.1bd9d3eb.js"><link rel="prefetch" href="/assets/js/27.beb716dd.js"><link rel="prefetch" href="/assets/js/28.bb093ca6.js"><link rel="prefetch" href="/assets/js/29.5b527549.js"><link rel="prefetch" href="/assets/js/3.8a6c11df.js"><link rel="prefetch" href="/assets/js/30.796276de.js"><link rel="prefetch" href="/assets/js/31.666b101e.js"><link rel="prefetch" href="/assets/js/32.654129d9.js"><link rel="prefetch" href="/assets/js/33.e479db51.js"><link rel="prefetch" href="/assets/js/4.e2a8d64a.js"><link rel="prefetch" href="/assets/js/5.dd4c966a.js"><link rel="prefetch" href="/assets/js/6.00a6c78e.js"><link rel="prefetch" href="/assets/js/7.9330d48e.js"><link rel="prefetch" href="/assets/js/8.560dd961.js"><link rel="prefetch" href="/assets/js/9.da6c1180.js">
    <link rel="stylesheet" href="/assets/css/0.styles.35aebc44.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">KSLEO</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/directory/" class="nav-link">
  ç¬”è®°ğŸ“’
</a></div><div class="nav-item"><a href="http://leokang28.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  åšå®¢ğŸ”—
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/directory/" class="nav-link">
  ç¬”è®°ğŸ“’
</a></div><div class="nav-item"><a href="http://leokang28.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  åšå®¢ğŸ”—
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="chapter-8-generic-types-traits-and-lifetimes"><a href="#chapter-8-generic-types-traits-and-lifetimes" class="header-anchor">#</a> Chapter 8 - Generic Types, Traits, and Lifetimes</h1> <p>æ¯ç§è¯­è¨€éƒ½æœ‰é’ˆå¯¹æ¦‚å¿µæŠ½è±¡çš„æœ‰æ•ˆå·¥å…·ã€‚Rustä¸­çš„å·¥å…·ä¹‹ä¸€æ˜¯<em>genericï¼ˆæ³›å‹ï¼‰</em>ã€‚æ³›å‹æ˜¯å¯¹ç±»å‹æˆ–å…¶ä»–å±æ€§çš„æŠ½è±¡ã€‚åœ¨ç¼–ç æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¸“æ³¨äºè¡¨è¾¾æ³›å‹çš„è¡Œä¸ºæˆ–è€…ä¸å…¶ä»–æ³›å‹ä¹‹é—´çš„å…³ç³»ï¼Œè€Œä¸ç”¨åœ¨æ„å®ƒåœ¨è¿è¡Œæ—¶ä»£è¡¨çš„æ˜¯ä»€ä¹ˆç±»å‹çš„æ•°æ®ã€‚å‡½æ•°ä¹Ÿå¯ä»¥æ¥æ”¶ä¸€äº›æ³›å‹å‚æ•°è€Œä¸æ˜¯å…·ä½“ç±»å‹çš„å‚æ•°ã€‚</p> <h3 id="æŠ½è±¡å‡½æ•°åˆ é™¤é‡å¤ä»£ç "><a href="#æŠ½è±¡å‡½æ•°åˆ é™¤é‡å¤ä»£ç " class="header-anchor">#</a> æŠ½è±¡å‡½æ•°åˆ é™¤é‡å¤ä»£ç </h3> <p>åœ¨å­¦ä¹ æ³›å‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹å¦‚ä½•é€šè¿‡å‡½æ•°æŠ½è±¡æ¥è§£å†³ä»£ç é‡å¤çš„é—®é¢˜ï¼Œç„¶åæˆ‘ä»¬ä¼šå°†æ³›å‹å‚æ•°å†åŠ å…¥è¿›æ¥ã€‚</p> <p>å…ˆçœ‹ä¸€ä¸ªå¯»æ‰¾æ•°ç»„ä¸­æœ€å¤§æ•°çš„ç¤ºä¾‹ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number_list <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> largest <span class="token operator">=</span> number_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> number <span class="token keyword">in</span> number_list <span class="token punctuation">{</span>
        <span class="token keyword">if</span> number <span class="token operator">&gt;</span> largest <span class="token punctuation">{</span>
            largest <span class="token operator">=</span> number<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest number is {}&quot;</span><span class="token punctuation">,</span> largest<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>å¦‚æœæˆ‘ä»¬è¦å¯»æ‰¾å¦å¤–ä¸€ä¸ªæ•°ç»„ä¸­çš„æœ€å¤§æ•°ï¼Œå¯ä»¥é‡å¤è¿™æ®µä»£ç ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number_list <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> largest <span class="token operator">=</span> number_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> number <span class="token keyword">in</span> number_list <span class="token punctuation">{</span>
        <span class="token keyword">if</span> number <span class="token operator">&gt;</span> largest <span class="token punctuation">{</span>
            largest <span class="token operator">=</span> number<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest number is {}&quot;</span><span class="token punctuation">,</span> largest<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> number_list <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">6000</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> largest <span class="token operator">=</span> number_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> number <span class="token keyword">in</span> number_list <span class="token punctuation">{</span>
        <span class="token keyword">if</span> number <span class="token operator">&gt;</span> largest <span class="token punctuation">{</span>
            largest <span class="token operator">=</span> number<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest number is {}&quot;</span><span class="token punctuation">,</span> largest<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>å¯ä»¥çœ‹å‡ºé™¤äº†æ•°ç»„ä¸­çš„æ•°æ®ä¸åŒï¼Œå…¶ä»–åœ°æ–¹çš„é€»è¾‘å®Œå…¨æ˜¯ä¸€æ ·çš„ã€‚è¿™æ ·å†™ä»£ç è™½ç„¶å¯ä»¥å¾—å‡ºæ­£ç¡®çš„ç»“æœï¼Œä½†æ˜¯æ˜¾å¾—å¤ªè¿‡å•°å—¦è€Œä¸”å®¹æ˜“å‡ºé”™ã€‚å¦‚æœæˆ‘ä»¬è¦ä¿®æ”¹å…¶ä¸­çš„é€»è¾‘ï¼Œæ¯”å¦‚æ”¹æˆå¯»æ‰¾æœ€å°çš„æ•°å­—ï¼Œé‚£ä¹ˆå°±å¾—å°†æ‰€æœ‰é‡å¤çš„ä»£ç éƒ½æ”¹ä¸€éã€‚</p> <p>ä¸ºäº†å»é™¤é‡å¤ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŠ½è±¡ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠä¸å˜çš„é€»è¾‘éƒ¨åˆ†å°è£…èµ·æ¥ï¼Œå¯å˜çš„éƒ¨åˆ†ï¼ˆæ•°ç»„ï¼‰é€šè¿‡å‚æ•°ä¼ é€’ã€‚è¿™è®©æˆ‘ä»¬çš„ä»£ç æ›´åŠ ç®€æ´ï¼Œè¡¨æ„æ¸…æ™°ä¹Ÿæ˜“äºç»´æŠ¤ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> largest<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">(</span>list<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> T <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> largest <span class="token operator">=</span> list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token operator">&amp;</span>item <span class="token keyword">in</span> list <span class="token punctuation">{</span>
        <span class="token keyword">if</span> item <span class="token operator">&gt;</span> largest <span class="token punctuation">{</span>
            largest <span class="token operator">=</span> item<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    largest
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number_list <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">largest</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>number_list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest number is {}&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> number_list <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">6000</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">largest</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>number_list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest number is {}&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>è¿™ä¸ªå‡½æ•°ç›®å‰è¿˜ä¸èƒ½ç¼–è¯‘é€šè¿‡ï¼Œå› ä¸ºè¿˜éœ€è¦ç”¨åˆ°ä¸€äº›ä¹‹åä¼šè®²åˆ°çš„å†…å®¹ã€‚</p> <h2 id="section-1-æ³›å‹"><a href="#section-1-æ³›å‹" class="header-anchor">#</a> Section 1 - æ³›å‹</h2> <p>æ³›å‹å³é€šç”¨ç±»å‹ï¼Œæ˜¯åœ¨è¿è¡Œæ—¶æ‰ç¡®å®šå…·ä½“è¿ç®—ç±»å‹çš„æŠ€æœ¯ã€‚é€šè¿‡æ³›å‹å£°æ˜å‡½æ•°å’Œç»“æ„ä½“ï¼Œåœ¨è°ƒç”¨æ—¶å¯ä»¥ä½¿ç”¨å¤šç§æ•°æ®ç±»å‹ã€‚é¦–å…ˆçœ‹çœ‹å¦‚ä½•é€šè¿‡æ³›å‹å£°æ˜å‡½æ•°ã€ç»“æ„ä½“ã€æšä¸¾å’Œæ–¹æ³•ç­‰ï¼Œä¹‹åå†è®¨è®ºä¸€ä¸‹æ³›å‹å¯¹äºæ€§èƒ½çš„å½±å“ã€‚</p> <h3 id="å‡½æ•°å£°æ˜"><a href="#å‡½æ•°å£°æ˜" class="header-anchor">#</a> å‡½æ•°å£°æ˜</h3> <p>ä½¿ç”¨æ³›å‹å£°æ˜å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨æ³›å‹å˜é‡æ¥æ›¿ä»£å‚æ•°å’Œè¿”å›å€¼çš„æ•°æ®ç±»å‹ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function">largest_i32</span><span class="token punctuation">(</span>list<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>i32<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> i32 <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> largest <span class="token operator">=</span> list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token operator">&amp;</span>item <span class="token keyword">in</span> list <span class="token punctuation">{</span>
        <span class="token keyword">if</span> item <span class="token operator">&gt;</span> largest <span class="token punctuation">{</span>
            largest <span class="token operator">=</span> item<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    largest
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function">largest_char</span><span class="token punctuation">(</span>list<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>char<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> char <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> largest <span class="token operator">=</span> list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token operator">&amp;</span>item <span class="token keyword">in</span> list <span class="token punctuation">{</span>
        <span class="token keyword">if</span> item <span class="token operator">&gt;</span> largest <span class="token punctuation">{</span>
            largest <span class="token operator">=</span> item<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    largest
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number_list <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">largest_i32</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>number_list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest number is {}&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> char_list <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token char string">'y'</span><span class="token punctuation">,</span> <span class="token char string">'m'</span><span class="token punctuation">,</span> <span class="token char string">'a'</span><span class="token punctuation">,</span> <span class="token char string">'q'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">largest_char</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>char_list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest char is {}&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>ä¸Šé¢åˆ†åˆ«æœ‰ä¸¤ä¸ªå‡½æ•°<code>largest_i32</code>å’Œ<code>largest_char</code>ï¼Œå®ƒä»¬æ¥æ”¶ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œä½†æ˜¯å†…éƒ¨æ‰€åšçš„äº‹æ˜¯ä¸€æ ·çš„é€»è¾‘ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªå‡½æ•°å¯ä»¥é€šè¿‡æ³›å‹æŠ½è±¡æˆä¸€ä¸ªå‡½æ•°ã€‚</p> <p>åœ¨å‡½æ•°ä¸­å°†ç±»å‹å‚æ•°åŒ–ï¼Œéœ€è¦å¯¹ç±»å‹å‚æ•°å‘½åï¼Œå°±åƒå¯¹æ™®é€šå‚æ•°å‘½åé‚£æ ·ã€‚å¯ä»¥ç”¨ä¸€ä¸ªæ ‡è¯†ç¬¦æ¥è¡¨ç¤ºç±»å‹å‚æ•°ï¼Œä¹ æƒ¯ä¸Šæˆ‘ä»¬ä¼šç”¨<code>T</code>æ¥è¡¨ç¤ºï¼Œå› ä¸ºTæ˜¯typeçš„ç¼©å†™ã€‚</p> <p>åœ¨å‡½æ•°ä½“ä¸­ä½¿ç”¨å‚æ•°æ—¶ï¼Œéœ€è¦å…ˆåœ¨å‡½æ•°å£°æ˜ä¸­å¯¹å‚æ•°å‘½åï¼Œå¥½è®©ç¼–è¯‘å™¨çŸ¥é“è¿™ä¸ªåç§°çš„å«ä¹‰æ˜¯ä»€ä¹ˆã€‚åŒæ ·çš„ï¼Œå½“æˆ‘ä»¬åœ¨å‡½æ•°å£°æ˜ä¸­ä½¿ç”¨ç±»å‹å‚æ•°å‰ï¼Œéœ€è¦å¯¹å…¶è¿›è¡Œå‘½åã€‚ç±»å‹å‚æ•°éœ€è¦ç”¨<code>&lt;&gt;</code>åŒ…èµ·æ¥ï¼Œå¹¶ä¸”ç½®äºå‡½æ•°åå’Œå‚æ•°åˆ—è¡¨ä¹‹é—´ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> largest<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">(</span>list<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> T <span class="token punctuation">{</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¿™ä¸ªå£°æ˜çš„å«ä¹‰æ˜¯ï¼Œ<code>largest</code>å‡½æ•°æ¥æ”¶ä¸€ä¸ªæ³›å‹<code>T</code>ï¼Œå‚æ•°<code>list</code>æ˜¯æ³›å‹<code>T</code>çš„åˆ‡ç‰‡ï¼Œå‡½æ•°è¿”å›ä¸€ä¸ª<code>T</code>ç±»å‹çš„å€¼ã€‚</p> <p>æ¥ä¸‹æ¥å°†<code>largest_i32</code>å’Œ<code>largest_char</code>å‡½æ•°é€šè¿‡æ³›å‹æŠ½è±¡ä¸ºä¸€ä¸ªå‡½æ•°ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> largest<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">(</span>list<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> T <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> largest <span class="token operator">=</span> list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token operator">&amp;</span>item <span class="token keyword">in</span> list <span class="token punctuation">{</span>
        <span class="token keyword">if</span> item <span class="token operator">&gt;</span> largest <span class="token punctuation">{</span>
            largest <span class="token operator">=</span> item<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    largest
<span class="token punctuation">}</span>
<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number_list <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">largest</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>number_list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest number is {}&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> char_list <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token char string">'y'</span><span class="token punctuation">,</span> <span class="token char string">'m'</span><span class="token punctuation">,</span> <span class="token char string">'a'</span><span class="token punctuation">,</span> <span class="token char string">'q'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">largest</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>char_list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest char is {}&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>æ­¤æ—¶ä»£ç ç¼–è¯‘ä¼šæç¤ºä¸€ä¸ªé”™è¯¯</p> <blockquote><p>error[E0369]: binary operation <code>&gt;</code> cannot be applied to type <code>T</code></p></blockquote> <p>è¿™é‡Œçš„å‡ºç°é”™è¯¯çš„åŸå› æ˜¯ï¼Œ<code>&gt;</code>æ“ä½œç¬¦ä¸èƒ½åœ¨æ‰€æœ‰å¯èƒ½çš„æ•°æ®ç±»å‹ä¸Šè¿ç®—ã€‚ä¸ºäº†è¿›è¡Œæ¯”è¾ƒè¿ç®—ï¼Œæ ‡å‡†åº“æä¾›äº†<code>std::cmp::PartialOrd</code>traitï¼Œç±»å‹å®ç°å®ƒå°±å¯ä»¥è·å¾—è¿›è¡Œæ¯”è¾ƒè¿ç®—çš„èƒ½åŠ›ã€‚è¿™ä¸ªåœ¨åç»­ç« èŠ‚ä¸­ä¼šä»‹ç»åˆ°ã€‚</p> <h3 id="ç»“æ„ä½“å£°æ˜"><a href="#ç»“æ„ä½“å£°æ˜" class="header-anchor">#</a> ç»“æ„ä½“å£°æ˜</h3> <p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æ³›å‹å¯¹ç»“æ„ä½“çš„å­—æ®µè¿›è¡Œå£°æ˜ã€‚è·Ÿå‡½æ•°å£°æ˜æ²¡ä»€ä¹ˆä¸åŒã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">struct</span> Point<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>
    y<span class="token punctuation">:</span> T<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> integer <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> float <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">4.0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>å¯ä»¥ä½¿ç”¨å¤šä¸ªæ³›å‹å‚æ•°æ¥ä»£è¡¨å¤šç§ä¸åŒçš„ç±»å‹ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">struct</span> Point<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> U<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>
    y<span class="token punctuation">:</span> U<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> integer <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">10.0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> float <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>ä½†æ˜¯æ³›å‹å‚æ•°çš„æ•°é‡ä¸å®œè¿‡å¤šï¼Œå¦åˆ™ä»£ç å¯è¯»æ€§ä¼šå˜å·®ã€‚å½“ä½ éœ€è¦ä½¿ç”¨åˆ°å¤šä¸ªæ³›å‹å˜é‡æ—¶ï¼Œè¯´æ˜ä½ çš„ä»£ç éœ€è¦é‡æ„åˆ°æ›´ç»†é¢—ç²’åº¦ã€‚</p> <h3 id="æšä¸¾å£°æ˜"><a href="#æšä¸¾å£°æ˜" class="header-anchor">#</a> æšä¸¾å£°æ˜</h3> <p>è·Ÿç»“æ„ä½“å£°æ˜ä¸€æ ·ï¼Œæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ã€‚æ¯”å¦‚ä¹‹å‰å¤šæ¬¡ä½¿ç”¨åˆ°çš„<code>Option&lt;T&gt;</code>å’Œ<code>Result&lt;T, E&gt;</code>æšä¸¾ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">enum</span> Option<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">Some</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">,</span>
    None<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">enum</span> Result<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> E<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">Ok</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">Err</span><span class="token punctuation">(</span>E<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>å½“ä½ çš„ä»£ç å‡ºç°å¤šä¸ªç›¸ä¼¼çš„ç»“æ„ä½“å’Œæšä¸¾ï¼Œè¿™äº›ç»“æ„ä½“å’Œæšä¸¾ä»…ä»…åªæœ‰æ•°æ®ç±»å‹ä¸åŒæ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨æ³›å‹å¯¹å…¶è¿›è¡ŒæŠ½è±¡ã€‚</p> <h3 id="æ–¹æ³•å£°æ˜"><a href="#æ–¹æ³•å£°æ˜" class="header-anchor">#</a> æ–¹æ³•å£°æ˜</h3> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">struct</span> Point<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>
    y<span class="token punctuation">:</span> T<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> Point<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span>T <span class="token punctuation">{</span>
        <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>x
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> p <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;p.x = {}&quot;</span><span class="token punctuation">,</span> p<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>æ³›å‹å‚æ•°<code>T</code>è¢«ç½®äº<code>impl</code>å…³é”®å­—ä¹‹åï¼Œæ–¹æ³•åä¹‹åçš„æ³›å‹å‚æ•°å°±å¯ä»¥çœç•¥ä¸å†™ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">impl</span> Point<span class="token operator">&lt;</span>f32<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function">distance_from_origin</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> f32 <span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>x<span class="token punctuation">.</span><span class="token function">powi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y<span class="token punctuation">.</span><span class="token function">powi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>è¿™æ®µä»£ç çš„å«ä¹‰æ˜¯ï¼Œ<code>Point&lt;f32&gt;</code>ä¸Šå®ç°äº†ä¸€ä¸ªæ–¹æ³•<code>distance_from_origin</code>ï¼Œå¯¹äºæ³›å‹<code>Point&lt;T&gt;</code>ï¼Œå½“<code>T</code>æ˜¯<code>f32</code>ä»¥å¤–çš„ç±»å‹æ—¶ï¼Œåˆ™å®ƒä¸å…·æœ‰<code>distance_from_origin</code>æ–¹æ³•ã€‚</p> <p>ç»“æ„ä½“çš„æ³›å‹å‚æ•°ä¸ä¸€å®šä¼šè¢«æ–¹æ³•å®šä¹‰æ—¶å…¨éƒ¨ä½¿ç”¨ã€‚å¯ä»¥åœ¨æ–¹æ³•ä¸ŠæŒ‡å®šä¸€äº›å…¶ä»–çš„æ³›å‹å‚æ•°ï¼Œè¿™äº›æ³›å‹å‚æ•°ä»…ä»…åœ¨è¯¥æ–¹æ³•ä¸Šç”Ÿæ•ˆã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">struct</span> Point<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> U<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>
    y<span class="token punctuation">:</span> U<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token punctuation">,</span> U<span class="token operator">&gt;</span> Point<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> U<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> mixup<span class="token operator">&lt;</span>V<span class="token punctuation">,</span> W<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> Point<span class="token operator">&lt;</span>V<span class="token punctuation">,</span> W<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> Point<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> W<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        Point <span class="token punctuation">{</span>
            x<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>
            y<span class="token punctuation">:</span> other<span class="token punctuation">.</span>y<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> p1 <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">10.4</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> p2 <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token char string">'c'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> p3 <span class="token operator">=</span> p1<span class="token punctuation">.</span><span class="token function">mixup</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;p3.x = {}, p3.y = {}&quot;</span><span class="token punctuation">,</span> p3<span class="token punctuation">.</span>x<span class="token punctuation">,</span> p3<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="ä½¿ç”¨æ³›å‹çš„ä»£ç æ€§èƒ½"><a href="#ä½¿ç”¨æ³›å‹çš„ä»£ç æ€§èƒ½" class="header-anchor">#</a> ä½¿ç”¨æ³›å‹çš„ä»£ç æ€§èƒ½</h3> <p>ä½ å¯èƒ½ä¼šæ€€ç–‘ä½¿ç”¨æ³›å‹ä¼šåœ¨è¿è¡Œæ—¶æœ‰ä¸€å®šçš„æ€§èƒ½æŸè€—ã€‚ä½†æ˜¯Ruståœ¨ä¸­ä½¿ç”¨æ³›å‹å’Œç‰¹å®šçš„æ•°æ®ç±»å‹ï¼Œåœ¨æ€§èƒ½ä¸Šæ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚</p> <p>Rusté€šè¿‡åœ¨ç¼–è¯‘é˜¶æ®µå¯¹ä½¿ç”¨äº†æ³›å‹çš„ä»£ç æ‰§è¡Œ<em>monomorphization</em>æ¥å®Œæˆæ€§èƒ½ä¼˜åŒ–ã€‚<em>monomorphization</em>æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µå°†æ³›å‹æ›¿æ¢æˆå…·ä½“æ•°æ®ç±»å‹çš„è¿›ç¨‹ã€‚åœ¨è¿™ä¸ªè¿›ç¨‹ä¸­ç¼–è¯‘å™¨æ‰§è¡Œä¸åˆ›å»ºæ³›å‹å‡½æ•°ç›¸åçš„æ“ä½œï¼Œç¼–è¯‘å™¨æŸ¥çœ‹æ‰€æœ‰è°ƒç”¨äº†æ³›å‹å£°æ˜çš„ä»£ç ï¼Œå¹¶ä¸”ç”Ÿæˆå¯¹åº”çš„å…·ä½“æ•°æ®ç±»å‹çš„ä»£ç ã€‚</p> <p>æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥çœ‹çœ‹å®ƒçš„å·¥ä½œåŸç†</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> integer <span class="token operator">=</span> <span class="token function">Some</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> float <span class="token operator">=</span> <span class="token function">Some</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>å½“Rustç¼–è¯‘è¿™æ®µä»£ç ï¼Œå®ƒä¼šæ‰§è¡Œmonomorphizationã€‚ç¼–è¯‘å™¨å‘ç°æœ‰ä¸¤å¤„ä»£ç è°ƒç”¨äº†<code>Option&lt;T&gt;</code>æšä¸¾çš„å®ä½“ï¼Œç¼–è¯‘å™¨ä¼šé’ˆå¯¹è¿™ä¸¤å¤„ä»£ç çš„ç±»å‹åˆ†åˆ«ç”Ÿæˆå¯¹åº”çš„<code>Option</code>æšä¸¾ã€‚å¯ä»¥çœ‹æˆæ˜¯æŠ½è±¡ä»£ç çš„ä¸€ä¸ªé€†æ“ä½œ</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">enum</span> Option_i32 <span class="token punctuation">{</span>
    <span class="token function">Some</span><span class="token punctuation">(</span>i32<span class="token punctuation">)</span><span class="token punctuation">,</span>
    None<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">enum</span> Option_f64 <span class="token punctuation">{</span>
    <span class="token function">Some</span><span class="token punctuation">(</span>f64<span class="token punctuation">)</span><span class="token punctuation">,</span>
    None<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> integer <span class="token operator">=</span> Option_i32<span class="token punctuation">::</span><span class="token function">Some</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> float <span class="token operator">=</span> Option_f64<span class="token punctuation">::</span><span class="token function">Some</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>ç”±äºRuståœ¨ç¼–è¯‘é˜¶æ®µç”Ÿæˆäº†ç›¸åº”çš„ä»£ç ï¼Œå› æ­¤åœ¨è¿è¡Œæ—¶å°±æ²¡æœ‰æ€§èƒ½æŸè€—äº†ã€‚</p> <h2 id="section-2-traits-defining-shared-behavior"><a href="#section-2-traits-defining-shared-behavior" class="header-anchor">#</a> Section 2 - Traits: Defining Shared Behavior</h2> <p><em>trait</em>å‘Šè¯‰ç¼–è¯‘å™¨ç‰¹å®šçš„ç±»å‹ä¸‹å…·æœ‰ä»€ä¹ˆåŠŸèƒ½ï¼Œå¹¶ä¸”æ˜¯å¦å¯¹å¤–æš´éœ²ã€‚</p> <blockquote><p>traitä¸å…¶ä»–ç±»å‹çš„<code>interface</code>æ¦‚å¿µç±»ä¼¼ï¼Œä½†ä¸å®Œå…¨ç›¸åŒã€‚</p></blockquote> <h3 id="å®šä¹‰trait"><a href="#å®šä¹‰trait" class="header-anchor">#</a> å®šä¹‰Trait</h3> <p>ç±»å‹çš„è¡Œä¸ºå–å†³äºæˆ‘ä»¬èƒ½åœ¨è¯¥ç±»å‹ä¸Šè°ƒç”¨çš„æ–¹æ³•ã€‚å¦‚æœå¤šç§ä¸åŒç±»å‹éƒ½å¯ä»¥è°ƒç”¨åŒä¸€ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒä»¬å°±å…·æœ‰ç›¸åŒçš„è¡Œä¸ºã€‚traitå°±æ˜¯å°†è¿™äº›ç›¸åŒæ–¹æ³•ç»„ç»‡åœ¨ä¸€èµ·ï¼Œå®šä¹‰ä¸€ä¸ªè¡Œä¸ºçš„é›†åˆã€‚</p> <p>ä¾‹å¦‚ï¼Œæœ‰ä¸€äº›ç»“æ„ä½“èƒ½å¤Ÿå­˜å‚¨ä¸€äº›ç±»å‹å’Œæ•°é‡çš„æ–‡æœ¬ï¼Œ<code>NewsArticle</code>å¯ä»¥å­˜å‚¨ä¸€ä¸ªæ–°é—»å†…å®¹ï¼›<code>Tweet</code>å¯ä»¥å­˜å‚¨è‡³å¤š280ä¸ªå­—ç¬¦çš„æ–‡æœ¬å†…å®¹ï¼Œå’Œæ ‡è¯†å®ƒæ˜¯æ–°æ¨æ–‡ã€è½¬æ¨è¿˜æ˜¯å›å¤å…¶ä»–æ¨æ–‡çš„ä¸€äº›å…ƒæ•°æ®ã€‚</p> <p>æˆ‘ä»¬æƒ³åšä¸€ä¸ªåª’ä½“èšåˆåº“ï¼Œç”¨æ¥å±•ç¤º<code>NewsArticle</code>æˆ–è€…<code>Tweet</code>å®ä¾‹çš„æ‘˜è¦å†…å®¹ã€‚å› æ­¤ï¼Œè¿™ä¸¤ç§ç±»å‹ä¸­éƒ½å¿…é¡»è¦æœ‰æ‘˜è¦æ•°æ®ï¼Œç„¶åé€šè¿‡è°ƒç”¨<code>summarize</code>æ–¹æ³•æ¥è·å–å®ä¾‹ä¸Šçš„æ‘˜è¦æ•°æ®ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">trait</span> Summary <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function">summarize</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> String<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>è¿™é‡Œç”¨<code>trait</code>å…³é”®å­—å®šä¹‰äº†ä¸€ä¸ªtraitã€‚åœ¨traitå†…éƒ¨ï¼Œå£°æ˜äº†ä¸€ä¸ªæ–¹æ³•ï¼Œå®ç°è¿™ä¸ªtraitçš„ç±»å‹å¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p> <p>åœ¨æ–¹æ³•å£°æ˜åï¼Œæ²¡æœ‰æ–¹æ³•ä½“ï¼Œè€Œæ˜¯ç”¨åˆ†å·ç»“æŸã€‚ä»»ä½•å®ç°äº†è¿™ä¸ªtraitçš„ç±»å‹éƒ½å¿…é¡»è‡ªå·±å®ç°è¿™ä¸ªæ–¹æ³•çš„æ–¹æ³•ä½“ã€‚ç¼–è¯‘å™¨ä¼šå¼ºåˆ¶é™å®šç±»å‹ä¸­å®ç°çš„æ–¹æ³•å’Œtraitä¸­çš„æ–¹æ³•å£°æ˜æ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚</p> <p>traitå¯ä»¥å£°æ˜å¤šä¸ªæ–¹æ³•ï¼Œæ¯ä¸ªæ–¹æ³•å ä¸€è¡Œå¹¶ä»¥åˆ†å·ç»“æŸã€‚</p> <h3 id="ç±»å‹å®ç°trait"><a href="#ç±»å‹å®ç°trait" class="header-anchor">#</a> ç±»å‹å®ç°trait</h3> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">struct</span> NewsArticle <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> headline<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">pub</span> location<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">pub</span> author<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">pub</span> content<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> Summary <span class="token keyword">for</span> NewsArticle <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function">summarize</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> String <span class="token punctuation">{</span>
        <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">&quot;{}, by {} ({})&quot;</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>headline<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>author<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>location<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">pub</span> <span class="token keyword">struct</span> Tweet <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> username<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">pub</span> content<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">pub</span> reply<span class="token punctuation">:</span> bool<span class="token punctuation">,</span>
    <span class="token keyword">pub</span> retweet<span class="token punctuation">:</span> bool<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> Summary <span class="token keyword">for</span> Tweet <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function">summarize</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> String <span class="token punctuation">{</span>
        <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">&quot;{}: {}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>username<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>content<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>åœ¨ç±»å‹ä¸Šå®ç°traitå’Œæ™®é€šçš„æ–¹æ³•æ‰©å±•ç±»ä¼¼ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œåœ¨<code>impl</code>ä¹‹åéœ€è¦åŠ ä¸Štraitåç§°ï¼Œç„¶ååœ¨åŠ ä¸Š<code>for</code>å…³é”®å­—ï¼Œæœ€åæ˜¯ç±»å‹åç§°ã€‚åœ¨<code>impl</code>ä»£ç å—é‡Œæœ‰å’Œtraitä¸€æ ·çš„æ–¹æ³•å£°æ˜ï¼Œä½†æ˜¯æ­¤æ—¶éœ€è¦å®ç°æ–¹æ³•ä½“ã€‚</p> <p>åœ¨å®ç°traitåï¼Œå°±å¯ä»¥åœ¨<code>NewsArticle</code>å’Œ<code>Tweet</code>ç±»å‹çš„å®ä¾‹ä¸Šè°ƒç”¨å®ç°çš„æ–¹æ³•äº†ï¼Œè°ƒç”¨æ–¹å¼å’Œæ™®é€šçš„æ–¹æ³•ä¸€æ ·ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> tweet <span class="token operator">=</span> Tweet <span class="token punctuation">{</span>
    username<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;horse_ebooks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    content<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span>
        <span class="token string">&quot;of course, as you probably already know, people&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    reply<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
    retweet<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;1 new tweet: {}&quot;</span><span class="token punctuation">,</span> tweet<span class="token punctuation">.</span><span class="token function">summarize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>æ³¨æ„ç”±äºæˆ‘ä»¬æ‰€æœ‰ä»£ç å†™åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå½“å…¶ä»–äººå®ç°è¿™ä¸ªtraitæ—¶ï¼Œåˆ™éœ€è¦é€šè¿‡ä¹‹å‰ç« èŠ‚è®²çš„æ¨¡å—è§„åˆ™ï¼ŒæŠŠtraitå…ˆå¼•å…¥ç„¶åæ‰èƒ½ä½¿ç”¨ã€‚</p> <p>traitå®ç°çš„ä¸€æ¡é™åˆ¶æ˜¯ï¼Œå½“è¢«å®ç°çš„traitæˆ–è€…è¦å®ç°çš„ç±»å‹æ˜¯æˆ‘ä»¬crateçš„æœ¬åœ°traitæˆ–ç±»å‹æ—¶ï¼Œæ‰å¯ä»¥è¿›è¡Œå®ç°ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥åœ¨<code>Tweet</code>ä¸Šå®ç°æ ‡å‡†åº“çš„<code>Display</code>traitï¼Œå› ä¸º<code>Tweet</code>æ˜¯æˆ‘ä»¬çš„æœ¬åœ°ç±»å‹ï¼›ä¹Ÿå¯ä»¥åœ¨<code>Vec&lt;T&gt;</code>ä¸Šå®ç°<code>Summary</code>traitï¼Œå› ä¸º<code>Summary</code>traitæ˜¯æˆ‘ä»¬çš„æœ¬åœ°traitã€‚</p> <p>ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½åœ¨å¤–éƒ¨ç±»å‹ä¸Šå®ç°å¤–éƒ¨traitï¼Œä¾‹å¦‚åœ¨<code>Vec&lt;T&gt;</code>ä¸Šå®ç°<code>Display</code>ã€‚è¿™ä¸ªé™åˆ¶æ˜¯ç¨‹åºå±æ€§ä¹‹ä¸€ç§°ä¹‹ä¸º<em>è¿è´¯æ€§ï¼ˆcoherenceï¼‰</em>ï¼Œæ›´å‡†ç¡®çš„è¯´åº”è¯¥ç§°ä¹‹ä¸º<em>å­¤å„¿è§„åˆ™ï¼ˆorphan ruleï¼‰</em>ã€‚è¿™æ¡è§„åˆ™ç¡®ä¿åˆ«äººä¸èƒ½ä¿®æ”¹ä½ çš„ä»£ç ï¼Œåä¹‹äº¦ç„¶ã€‚å¦‚æœæ²¡æœ‰è¿™æ¡è§„åˆ™ï¼Œé‚£ä¹ˆä¸¤ä¸ªcrateå¯ä»¥åŒæ—¶ç»™åŒä¸€ä¸ªç±»å‹å®ç°åŒä¸€ä¸ªtraitï¼Œè¿™æ ·ç¼–è¯‘å™¨å°±ä¸çŸ¥é“è¦è°ƒç”¨å“ªä¸ªå®ç°äº†ã€‚</p> <h3 id="é»˜è®¤å®ç°"><a href="#é»˜è®¤å®ç°" class="header-anchor">#</a> é»˜è®¤å®ç°</h3> <p>æœ‰æ—¶åœ¨å®šä¹‰traitæ—¶ï¼Œå¯¹å®ƒä¸‹é¢çš„æ–¹æ³•å®ç°é»˜è®¤çš„é€»è¾‘ã€‚ä¹‹åï¼Œåœ¨æˆ‘ä»¬å®ç°traitæ—¶ï¼Œå¯ä»¥é€‰æ‹©ä¿ç•™æˆ–è€…è¦†ç›–é»˜è®¤å®ç°ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">trait</span> Summary <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function">summarize</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> String <span class="token punctuation">{</span>
        String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;(Read more...)&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>åœ¨ä¸è¦†ç›–é»˜è®¤å®ç°æ—¶ï¼Œ<code>impl</code>åé¢è·Ÿä¸€ä¸ªç©ºçš„blockå°±å¥½ã€‚traitè¿›è¡Œæ–¹æ³•çš„é»˜è®¤é€»è¾‘ç¼–å†™ï¼Œä¸ä¼šå½±å“æˆ‘ä»¬å®ç°è¯¥traitçš„ä»£ç ï¼Œå› ä¸ºè¦†ç›–å’Œå®ç°traitåœ¨è¯­æ³•ä¸Šéƒ½æ˜¯ä¸€è‡´çš„ã€‚</p> <p>é»˜è®¤å®ç°çš„æ–¹æ³•ä¸­ï¼Œå¯ä»¥è°ƒç”¨traitä¸­çš„å…¶ä»–æ–¹æ³•ï¼Œå°±ç®—è¢«è°ƒç”¨çš„æ–¹æ³•æ²¡æœ‰é»˜è®¤å®ç°ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œtraitå¯ä»¥æä¾›å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦å®ç°å…¶ä¸­ä¸€éƒ¨åˆ†ä»£ç ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">trait</span> Summary <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function">summarize_author</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> String<span class="token punctuation">;</span>

    <span class="token keyword">fn</span> <span class="token function">summarize</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> String <span class="token punctuation">{</span>
        <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">&quot;(Read more from {}...)&quot;</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">summarize_author</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>è¦ä½¿ç”¨<code>summarize</code>æ–¹æ³•ï¼Œéœ€è¦å…ˆå®ç°å®ƒè°ƒç”¨çš„<code>summarize_author</code>æ–¹æ³•ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">impl</span> Summary <span class="token keyword">for</span> Tweet <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function">summarize_author</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> String <span class="token punctuation">{</span>
        <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">&quot;@{}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>username<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> tweet <span class="token operator">=</span> Tweet <span class="token punctuation">{</span>
    username<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;horse_ebooks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    content<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span>
        <span class="token string">&quot;of course, as you probably already know, people&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    reply<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
    retweet<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;1 new tweet: {}&quot;</span><span class="token punctuation">,</span> tweet<span class="token punctuation">.</span><span class="token function">summarize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// output: 1 new tweet: (Read more from @horse_ebooks...)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>è¦†ç›–å®ç°çš„æ–¹æ³•æ˜¯ä¸å¯èƒ½è°ƒç”¨åŒä¸€ä¸ªé»˜è®¤æ–¹æ³•çš„ã€‚</p> <h3 id="traitä½œä¸ºå‚æ•°"><a href="#traitä½œä¸ºå‚æ•°" class="header-anchor">#</a> Traitä½œä¸ºå‚æ•°</h3> <p>é€šè¿‡<code>impl Trait</code>è¯­æ³•å°†traitä½œä¸ºå‚æ•°ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">notify</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">impl</span> Summary<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Breaking news! {}&quot;</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span><span class="token function">summarize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>æˆ‘ä»¬åœ¨å‚æ•°<code>item</code>ä¹‹åæ²¡æœ‰æŒ‡å®šæ•°æ®ç±»å‹ï¼Œè€Œæ˜¯ç”¨<code>impl</code>å…³é”®å­—å’Œtraitåç§°ã€‚è¿™æ ·è¿™ä¸ªå‚æ•°å°±å¯ä»¥æ¥æ”¶ä»»ä½•å®ç°äº†è¿™ä¸ªtraitçš„ç±»å‹ã€‚åœ¨<code>notify</code>å‡½æ•°ä½“ä¸­ï¼Œå¯ä»¥é€šè¿‡<code>item</code>è°ƒç”¨æ‰€æœ‰<code>Summary</code>ä¸Šè¢«<code>item</code>çš„ç±»å‹å®ç°äº†çš„æ–¹æ³•æˆ–è€…é»˜è®¤æ–¹æ³•ã€‚</p> <h4 id="trait-bound-syntax"><a href="#trait-bound-syntax" class="header-anchor">#</a> Trait Bound Syntax</h4> <p><code>impl Trait</code>æ–¹æ³•æ˜¯å¦å¤–ä¸€ç§å½¢å¼çš„è¯­æ³•ç³–ï¼Œè¯¥å½¢å¼æˆä¸º<em>traitç»‘å®šï¼ˆtrait boundï¼‰</em>ã€‚å®ƒçš„ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> notify<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Summary<span class="token operator">&gt;</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> <span class="token operator">&amp;</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Breaking news! {}&quot;</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span><span class="token function">summarize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>è¿™ç§å½¢å¼è·Ÿ<code>impl Trait</code>è¯­æ³•ç­‰ä»·ï¼Œä½†æ˜¯æ¯”è¾ƒå†—é•¿ã€‚<code>impl Trait</code>è¯­æ³•ä½¿ç”¨æ›´æ–¹ä¾¿ï¼Œå¹¶ä¸”åœ¨å¤§å¤šæ•°ç®€å•åœºæ™¯ä¸‹ä»£ç æ›´ç®€æ´ã€‚traitç»‘å®šèƒ½è§£å†³æ›´å¤æ‚çš„åœºæ™¯ã€‚æ¯”å¦‚ä¸¤ä¸ªå‚æ•°çš„æƒ…å†µï¼š</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">notify</span><span class="token punctuation">(</span>item1<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">impl</span> Summary<span class="token punctuation">,</span> item2<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">impl</span> Summary<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¦‚æœæˆ‘ä»¬æƒ³è¦<code>item1</code>å’Œ<code>item2</code>çš„ç±»å‹æ˜¯ä¸åŒçš„ï¼Œé‚£ä¹ˆ<code>impl Trait</code>æ–¹æ³•æ›´åˆé€‚ã€‚ä½†æ˜¯å¦‚æœéœ€è¦å¼ºåˆ¶ä¸¤ä¸ªå‚æ•°çš„ç±»å‹æ˜¯ä¸€è‡´çš„ï¼Œé‚£ä¹ˆåªæœ‰traitç»‘å®šèƒ½å®ç°ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> notify<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Summary<span class="token operator">&gt;</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> <span class="token operator">&amp;</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ³›å‹å‚æ•°<code>T</code>ä¿è¯<code>item1</code>å’Œ<code>item2</code>çš„ç±»å‹å¿…é¡»æ˜¯ä¸€è‡´çš„ã€‚</p> <h4 id="é€šè¿‡-è¯­æ³•å£°æ˜å¤šä¸ªtrait-bound"><a href="#é€šè¿‡-è¯­æ³•å£°æ˜å¤šä¸ªtrait-bound" class="header-anchor">#</a> é€šè¿‡<code>+</code>è¯­æ³•å£°æ˜å¤šä¸ªtrait bound</h4> <p>æˆ‘ä»¬å¯ä»¥æŒ‡å®šå¤šä¸ªtrait boundã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">notify</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token keyword">impl</span> Summary <span class="token operator">+</span> Display<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>+</code>è¯­æ³•ä¹Ÿé€‚ç”¨äºtrait bound</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> notify<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Summary <span class="token operator">+</span> DisPlay<span class="token operator">&gt;</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> <span class="token operator">&amp;</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="ä½¿ç”¨whereæ¡ä»¶ç®€åŒ–trait-bound"><a href="#ä½¿ç”¨whereæ¡ä»¶ç®€åŒ–trait-bound" class="header-anchor">#</a> ä½¿ç”¨<code>where</code>æ¡ä»¶ç®€åŒ–trait bound</h4> <p>ä½¿ç”¨å¤ªå¤štrait boundä¹Ÿæœ‰ç¼ºç‚¹ã€‚æ¯ä¸ªæ³›å‹å‚æ•°éƒ½æœ‰å®ƒè‡ªå·±çš„trait boundï¼Œå› æ­¤å¤šä¸ªæ³›å‹å‚æ•°çš„å‡½æ•°åœ¨æ³›å‹å‚æ•°åˆ—è¡¨å’Œå‚æ•°åˆ—è¡¨ä¸­ä¼šåŒ…å«å¾ˆå¤štrait boundä¿¡æ¯ï¼Œè®©å‡½æ•°å£°æ˜å˜å¾—å†—é•¿éš¾ä»¥ç†è§£ã€‚å› æ­¤ï¼Œåœ¨å‡½æ•°å£°æ˜åå¼•å…¥<code>where</code>æ¡ä»¶å¯ä»¥åšåˆ°ç®€åŒ–çš„ä½œç”¨ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// before</span>
<span class="token keyword">fn</span> some_function<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Display <span class="token operator">+</span> Clone<span class="token punctuation">,</span> U<span class="token punctuation">:</span> Clone <span class="token operator">+</span> Debug<span class="token operator">&gt;</span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span>T<span class="token punctuation">,</span> u<span class="token punctuation">:</span> <span class="token operator">&amp;</span>U<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> i32 <span class="token punctuation">{</span>
<span class="token comment">// with where</span>
<span class="token keyword">fn</span> some_function<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> U<span class="token operator">&gt;</span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span>T<span class="token punctuation">,</span> u<span class="token punctuation">:</span> <span class="token operator">&amp;</span>U<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> i32
    <span class="token keyword">where</span> T<span class="token punctuation">:</span> Display <span class="token operator">+</span> Clone<span class="token punctuation">,</span>
          U<span class="token punctuation">:</span> Clone <span class="token operator">+</span> Debug
<span class="token punctuation">{</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="returning-types-that-implement-traits"><a href="#returning-types-that-implement-traits" class="header-anchor">#</a> Returning Types that Implement Traits</h3> <p><code>impl Trait</code>è¯­æ³•åŒæ ·å¯ä»¥ç”¨åœ¨å‡½æ•°å£°æ˜ä¸­çš„è¿”å›ç±»å‹éƒ¨åˆ†ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function">returns_summarizable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">impl</span> Summary <span class="token punctuation">{</span>
    Tweet <span class="token punctuation">{</span>
        username<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;horse_ebooks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        content<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span>
            <span class="token string">&quot;of course, as you probably already know, people&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        reply<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        retweet<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>è¿”å›å®ç°äº†ç‰¹å®štraitç±»å‹çš„åŠŸèƒ½åœ¨é—­åŒ…å’Œè¿­ä»£å™¨çš„åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ã€‚é—­åŒ…å’Œè¿­ä»£å™¨åˆ›å»ºçš„ç±»å‹åªæœ‰ç¼–è¯‘å™¨çŸ¥é“ï¼Œæˆ–è€…åˆ—ä¸¾è¿™äº›ç±»å‹ä¼šéå¸¸é•¿ã€‚<code>impl Trait</code>è¯­æ³•è®©ä½ åªéœ€è¦æŒ‡å®šè¿”å›ä¸€ä¸ªå®ç°äº†<code>Iterator</code>traitçš„ç±»å‹å°±å¥½ï¼Œä¸ç”¨å†™è¿‡é•¿çš„ç±»å‹ä»£ç ã€‚</p> <p>ä½†æ˜¯ï¼Œ<code>impl Trait</code>è¯­æ³•ç”¨äºè¿”å›ç±»å‹æ—¶ï¼Œå‡½æ•°åªèƒ½è¿”å›ä¸€ç§ç±»å‹ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function">returns_summarizable</span><span class="token punctuation">(</span>switch<span class="token punctuation">:</span> bool<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">impl</span> Summary <span class="token punctuation">{</span>
    <span class="token keyword">if</span> switch <span class="token punctuation">{</span>
        NewsArticle <span class="token punctuation">{</span>
            headline<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Penguins win the Stanley Cup Championship!&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            location<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Pittsburgh, PA, USA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            author<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Iceburgh&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            content<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span>
                &quot;The Pittsburgh Penguins <span class="token keyword">once</span> again are the best \
                 hockey team <span class="token keyword">in</span> the NHL<span class="token punctuation">.</span>&quot;<span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        Tweet <span class="token punctuation">{</span>
            username<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;horse_ebooks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            content<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span>
                <span class="token string">&quot;of course, as you probably already know, people&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            reply<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
            retweet<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>è¿™ä¸ªå‡½æ•°è¿”å›<code>NewsArticle</code>å’Œ<code>Tweet</code>ä¸¤ç§ç±»å‹ï¼Œç”±äºè¢«<code>impl Trait</code>è¯­æ³•åœ¨ç¼–è¯‘å™¨ä¸­çš„å®ç°æ‰€é™åˆ¶ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ä¸ä¼šç¼–è¯‘é€šè¿‡çš„ã€‚åœ¨åé¢çš„ç« èŠ‚ä¼šä»‹ç»åˆ°å¦‚ä½•å®ç°è¿™ç§åŠŸèƒ½ã€‚</p> <h3 id="ä¿®æ”¹largestå‡½æ•°"><a href="#ä¿®æ”¹largestå‡½æ•°" class="header-anchor">#</a> ä¿®æ”¹<code>largest</code>å‡½æ•°</h3> <p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ä¿®æ”¹æœ¬ç« å¼€å¤´çš„ç¤ºä¾‹å‡½æ•°äº†ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> largest<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> PartialOrd <span class="token operator">+</span> Copy<span class="token operator">&gt;</span><span class="token punctuation">(</span>list<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> T <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> largest <span class="token operator">=</span> list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token operator">&amp;</span>item <span class="token keyword">in</span> list <span class="token punctuation">{</span>
        <span class="token keyword">if</span> item <span class="token operator">&gt;</span> largest <span class="token punctuation">{</span>
            largest <span class="token operator">=</span> item<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    largest
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number_list <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">largest</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>number_list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest number is {}&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> char_list <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token char string">'y'</span><span class="token punctuation">,</span> <span class="token char string">'m'</span><span class="token punctuation">,</span> <span class="token char string">'a'</span><span class="token punctuation">,</span> <span class="token char string">'q'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">largest</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>char_list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest char is {}&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><code>PartialOrd</code>traité™åˆ¶å‚æ•°ç±»å‹è¦æœ‰<code>&gt;</code>æ“ä½œç¬¦è®¡ç®—çš„èƒ½åŠ›ï¼Œ<code>Copy</code>traité™åˆ¶å‚æ•°ç±»å‹åªèƒ½æ˜¯<em>stack-only</em>çš„ï¼Œæˆ–è€…å¯ä»¥ç”¨<code>Clone</code>traitæ›¿ä»£ã€‚ä½†æ˜¯<code>clone</code>æ–¹æ³•ä¼šåœ¨heapä¸Šåˆ†é…å†…å­˜ï¼Œå¦‚æœæ•°æ®é‡å¾ˆå¤§çš„è¯ä¼šæœ‰æ€§èƒ½æŸè€—ã€‚å¦å¤–ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯é€šè¿‡è¿”å›å¼•ç”¨<code>&amp;T</code>è€Œä¸æ˜¯<code>T</code>ã€‚åˆ™å¯ä»¥çœç•¥<code>Copy</code>traitã€‚</p> <h3 id="using-trait-bounds-to-conditionally-implement-methods"><a href="#using-trait-bounds-to-conditionally-implement-methods" class="header-anchor">#</a> Using Trait Bounds to Conditionally Implement Methods</h3> <p>å°†Trait boundç”¨äº<code>impl</code>å¯ä»¥è®©æˆ‘ä»¬æœ‰æ¡ä»¶çš„å®ç°traitä¸­çš„æ–¹æ³•ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">use</span> std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span>Display<span class="token punctuation">;</span>

<span class="token keyword">struct</span> Pair<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>
    y<span class="token punctuation">:</span> T<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> Pair<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function">new</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> T<span class="token punctuation">,</span> y<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Display <span class="token operator">+</span> PartialOrd<span class="token operator">&gt;</span> Pair<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function">cmp_display</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token keyword">self</span><span class="token punctuation">.</span>x <span class="token operator">&gt;=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y <span class="token punctuation">{</span>
            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest member is x = {}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest member is y = {}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><code>Pair&lt;T&gt;</code>ä¸Šçš„newæ–¹æ³•ä»»ä½•ç±»å‹éƒ½ä¼šè¢«å®ç°ï¼Œè€Œ<code>cmp_display</code>æ–¹æ³•åªæœ‰<code>T</code>ç±»å‹å®ç°äº†<code>Display</code>å’Œ<code>partialOrd</code>traitæ—¶æ‰ä¼šè¢«å®ç°ã€‚</p> <p>è¿™ä¸ªé™åˆ¶æ¡ä»¶ä¹Ÿå¯ä»¥ç”¨äºç»™ç±»å‹å®ç°traitæ—¶ã€‚ä¸ºæŸäº›æ»¡è¶³trait boundæ¡ä»¶çš„ç±»å‹å®ç°ç‰¹å®šçš„traitåœ¨Rustä¸­ç§°ä¸º<em>blanket implementations</em>ï¼Œè¿™ä¸ªåšæ³•è¢«å¹¿æ³›çš„åº”ç”¨äºRustæ ‡å‡†åº“ä¸­ã€‚ä¾‹å¦‚ï¼Œæ ‡å‡†åº“å®ç°äº†ä¸ºæ‰€æœ‰å®ç°äº†<code>Display</code>traitçš„ç±»å‹å®ç°äº†<code>ToString</code>traitã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Display<span class="token operator">&gt;</span> ToString <span class="token keyword">for</span> T <span class="token punctuation">{</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Traitå’Œtrait boundå¯ä»¥è®©æˆ‘ä»¬é€šè¿‡æ³›å‹å‚æ•°æŠ½è±¡ä»£ç ï¼ŒåŒæ—¶å¯ä»¥å‘ç¼–è¯‘å™¨æŒ‡æ˜æˆ‘ä»¬éœ€è¦æ³›å‹ç±»å‹å…·æœ‰ä»€ä¹ˆæ ·çš„åŠŸèƒ½ã€‚ç„¶åç¼–è¯‘å™¨å°±èƒ½æ ¹æ®æˆ‘ä»¬æä¾›çš„ä¿¡æ¯å»æ£€æŸ¥æˆ‘ä»¬å…·ä½“ä½¿ç”¨çš„ç±»å‹æœ‰æ²¡æœ‰å®ç°è¿™äº›åŠŸèƒ½ã€‚åœ¨åŠ¨æ€ç±»å‹è¯­è¨€ä¸­ï¼Œå¦‚æœæˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªç±»å‹ä¸Šæ²¡æœ‰å®šä¹‰çš„æ–¹æ³•ï¼Œé‚£ä¹ˆä¼šåœ¨è¿è¡Œæ—¶å‡ºç°é”™è¯¯ã€‚Ruståœ¨ç¼–è¯‘é˜¶æ®µå°±è§£å†³äº†è¿™äº›é”™è¯¯ï¼Œå®ƒå¼ºåˆ¶æˆ‘ä»¬åœ¨ä»£ç è¿è¡Œä¹‹å‰è§£å†³è¿™äº›æ½œåœ¨é”™è¯¯ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿä¸éœ€è¦å†åœ¨è¿è¡Œæ—¶ä»£ç ä¸­æ£€æŸ¥æ–¹æ³•æ˜¯å¦å­˜åœ¨ã€‚è¿™æ ·æ—¢æå‡äº†æ€§èƒ½ï¼Œåˆæ²¡æœ‰æŸå¤±æ³›å‹çš„åŠ¨æ€æ€§ã€‚</p> <h2 id="section-3-ç”¨lifetimeséªŒè¯å¼•ç”¨"><a href="#section-3-ç”¨lifetimeséªŒè¯å¼•ç”¨" class="header-anchor">#</a> Section 3 - ç”¨LifetimeséªŒè¯å¼•ç”¨</h2> <p>æˆ‘ä»¬åœ¨ä¹‹å‰çš„<a href="/Rust/02-ownership.html#section-2-references-and-borrowing">ç« èŠ‚</a>ä¸­æ²¡æœ‰è®²åˆ°çš„ä¸€ä¸ªæ¦‚å¿µæ˜¯ï¼ŒRustä¸­çš„å¼•ç”¨éƒ½æœ‰<em>ç”Ÿå‘½å‘¨æœŸï¼ˆlifetimesï¼‰</em>ï¼Œæ˜¯å¼•ç”¨æœ‰æ•ˆçš„ä½œç”¨åŸŸèŒƒå›´ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç”Ÿå‘½å‘¨æœŸæ˜¯éšå¼å’Œè¢«æ¨æ–­çš„ï¼Œå°±åƒæ•°æ®ç±»å‹æ˜¯è¢«æ¨æ–­çš„ä¸€æ ·ã€‚å½“ç±»å‹æœ‰å¤šç§å¯èƒ½æ—¶ï¼Œæˆ‘ä»¬å°±å¿…é¡»æŒ‡å®šç±»å‹ã€‚åŒæ ·çš„ï¼Œå½“ç”Ÿå‘½å‘¨æœŸé€šè¿‡é›†ä¸­ä¸åŒçš„æ–¹å¼å…³è”æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¿…é¡»æŒ‡å®šã€‚Rustè¦æ±‚æˆ‘ä»¬ä½¿ç”¨æ³›å‹ç”Ÿå‘½å‘¨æœŸå‚æ•°æŒ‡æ˜å…³è”æ–¹å¼æ¥ç¡®ä¿çœŸæ­£çš„å¼•ç”¨åœ¨è¿è¡Œæ—¶æ˜¯ç»å¯¹æœ‰æ•ˆçš„ã€‚</p> <p>ç”Ÿå‘½å‘¨æœŸçš„æ¦‚å¿µä¸å…¶ä»–è¯­è¨€ä¸­çš„å·¥å…·æœ‰äº›ä¸åŒï¼Œå¯ä»¥è¯´æ˜¯Rustæœ€ç‹¬ç‰¹çš„åŠŸèƒ½ã€‚è¿™èŠ‚ä¸ä¼šä»‹ç»ç”Ÿå‘½å‘¨æœŸçš„å…¨éƒ¨å†…å®¹ï¼Œä½†æ˜¯ä¼šå¯¹ä½ æœ‰å¯èƒ½é‡åˆ°çš„å¤šç§ç”Ÿå‘½å‘¨æœŸè¯­æ³•ä½œè®¨è®ºï¼Œå¥½ç†Ÿæ‚‰ç”Ÿå‘½å‘¨æœŸçš„æ¦‚å¿µã€‚</p> <h3 id="é˜²æ­¢æ‚¬ç©ºæŒ‡é’ˆ"><a href="#é˜²æ­¢æ‚¬ç©ºæŒ‡é’ˆ" class="header-anchor">#</a> é˜²æ­¢æ‚¬ç©ºæŒ‡é’ˆ</h3> <p>ç”Ÿå‘½å‘¨æœŸçš„ä¸»è¦ç›®æ ‡æ˜¯é˜²æ­¢å‡ºç°æ‚¬ç©ºæŒ‡é’ˆã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token punctuation">{</span>
    <span class="token keyword">let</span> r<span class="token punctuation">;</span>

    <span class="token punctuation">{</span>
        <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        r <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;r: {}&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// error[E0597]: `x` does not live long enough</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>å‡å¦‚æˆ‘ä»¬è¿è¡Œè¿™æ®µä»£ç ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥ä¸€ä¸ªé”™è¯¯ã€‚å› ä¸ºå†…éƒ¨ä½œç”¨åŸŸç»“æŸæ—¶ï¼Œxå’Œå®ƒçš„å¼•ç”¨ä¹Ÿè¢«é”€æ¯äº†ã€‚å¦‚æœè¿™ä¸ªä»£ç èƒ½å¤Ÿè¿è¡Œï¼Œé‚£ä¹ˆrå°†æŒ‡å‘ä¸€å—å·²ç»è¢«é‡Šæ”¾çš„å†…å­˜ï¼Œä¹‹åä»£ç çš„è¿è¡Œè‚¯å®šä¸ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸã€‚Rusté€šè¿‡borrow checkeråˆ¤æ–­ä»£ç æ˜¯å¦æœ‰æ•ˆã€‚</p> <h3 id="the-borrow-checker"><a href="#the-borrow-checker" class="header-anchor">#</a> The Borrow Checker</h3> <p>Rustç¼–è¯‘å™¨ç”¨<em>borrow checker</em>æ¥æ¯”è¾ƒä½œç”¨åŸŸï¼Œåˆ¤æ–­å¼•ç”¨æ˜¯å¦æœ‰æ•ˆã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token punctuation">{</span>
    <span class="token keyword">let</span> r<span class="token punctuation">;</span>                <span class="token comment">// ---------+-- 'a</span>
                          <span class="token comment">//          |</span>
    <span class="token punctuation">{</span>                     <span class="token comment">//          |</span>
        <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>        <span class="token comment">// -+-- 'b  |</span>
        r <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span>           <span class="token comment">//  |       |</span>
    <span class="token punctuation">}</span>                     <span class="token comment">// -+       |</span>
                          <span class="token comment">//          |</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;r: {}&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//          |</span>
<span class="token punctuation">}</span>                         <span class="token comment">// ---------+</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>ç”¨<code>'a</code>ä»£è¡¨rçš„ç”Ÿå‘½å‘¨æœŸï¼Œ<code>'b</code>ä»£è¡¨xçš„ç”Ÿå‘½å‘¨æœŸã€‚å¯ä»¥çœ‹åˆ°ï¼Œå†…éƒ¨çš„<code>'b</code>ç”Ÿå‘½å‘¨æœŸæ˜¯è¦æ¯”å¤–éƒ¨çš„<code>'a</code>ç”Ÿå‘½å‘¨æœŸå°çš„ã€‚åœ¨ç¼–è¯‘é˜¶æ®µï¼Œç¼–è¯‘å™¨ä¼šå¯¹æ¯”è¿™ä¸¤ä¸ªå˜é‡çš„ç”Ÿå‘½å‘¨æœŸå¤§å°ï¼Œå®ƒä¼šå‘ç°<code>r</code>çš„ç”Ÿå‘½å‘¨æœŸæ›´å¤§ï¼Œä½†æ˜¯å®ƒæŒ‡å‘äº†ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ›´å°çš„å†…å­˜åŒºåŸŸï¼Œæ‰€ä»¥ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token punctuation">{</span>
    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>            <span class="token comment">// ----------+-- 'b</span>
                          <span class="token comment">//           |</span>
    <span class="token keyword">let</span> r <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span>           <span class="token comment">// --+-- 'a  |</span>
                          <span class="token comment">//   |       |</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;r: {}&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//   |       |</span>
                          <span class="token comment">// --+       |</span>
<span class="token punctuation">}</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>è¿™é‡Œ<code>x</code>çš„ç”Ÿå‘½å‘¨æœŸ<code>'b</code>æ¯”<code>r</code>çš„ç”Ÿå‘½å‘¨æœŸ<code>'a</code>å¤§ï¼Œé‚£ä¹ˆ<code>r</code>å¯ä»¥æŒ‡å‘<code>x</code>ï¼Œå› ä¸ºå½“<code>x</code>æœ‰æ•ˆæ—¶ï¼Œå®ƒçš„å¼•ç”¨<code>r</code>ä¹Ÿä¸€å®šæœ‰æ•ˆã€‚</p> <h3 id="å‡½æ•°çš„æ³›å‹ç”Ÿå‘½å‘¨æœŸ"><a href="#å‡½æ•°çš„æ³›å‹ç”Ÿå‘½å‘¨æœŸ" class="header-anchor">#</a> å‡½æ•°çš„æ³›å‹ç”Ÿå‘½å‘¨æœŸ</h3> <p>å†™ä¸€ä¸ªæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²é•¿åº¦çš„å‡½æ•°<code>longest</code>ã€‚æ¥æ”¶ä¸¤ä¸ª<code>&amp;str</code>å‚æ•°ï¼Œè¿”å›ä¸€ä¸ª<code>&amp;str</code>æ•°æ®ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function">longest</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span>str <span class="token punctuation">{</span>
    <span class="token keyword">if</span> x<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> y<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        x
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        y
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> string1 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;abcd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> string2 <span class="token operator">=</span> <span class="token string">&quot;xyz&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">longest</span><span class="token punctuation">(</span>string1<span class="token punctuation">.</span><span class="token function">as_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> string2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The longest string is {}&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// error[E0106]: missing lifetime specifier</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>ä¸Šé¢<code>longest</code>å‡½æ•°çš„å®ç°ï¼Œç¼–è¯‘é˜¶æ®µä¼šæŠ¥é”™ã€‚è¿”å›ç±»å‹éœ€è¦ä¸€ä¸ªæ³›å‹ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼Œå› ä¸ºRustä¸çŸ¥é“è¿”å›çš„å¼•ç”¨æŒ‡å‘<code>x</code>è¿˜æ˜¯<code>y</code>ã€‚äº‹å®ä¸Šå› ä¸º<code>if</code>è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬è‡ªå·±ä¹Ÿä¸çŸ¥é“ä¼šæŒ‡å‘å“ªä¸€ä¸ªã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé”™è¯¯ï¼Œéœ€è¦å®šä¹‰æ³›å‹ç”Ÿå‘½å‘¨æœŸå‚æ•°æ¥ç¡®å®šå¼•ç”¨ä¹‹é—´çš„å…³ç³»ï¼Œç„¶å<code>borrow checker</code>æ‰èƒ½è¿›è¡Œåˆ†æã€‚</p> <h3 id="ç”Ÿå‘½å‘¨æœŸå£°æ˜è¯­æ³•"><a href="#ç”Ÿå‘½å‘¨æœŸå£°æ˜è¯­æ³•" class="header-anchor">#</a> ç”Ÿå‘½å‘¨æœŸå£°æ˜è¯­æ³•</h3> <p>ç”Ÿå‘½å‘¨æœŸå£°æ˜ä¸ä¼šæ”¹å˜ä»»ä½•å¼•ç”¨çœŸæ­£çš„ç”Ÿå‘½å‘¨æœŸã€‚å°±åƒå‡½æ•°å¯ä»¥æ¥æ”¶æ³›å‹ç±»å‹å‚æ•°æ¥æ¥æ”¶ä»»ä½•æ•°æ®ç±»å‹ï¼Œé€šè¿‡å®šä¹‰æ³›å‹ç”Ÿå‘½å‘¨æœŸï¼Œå‡½æ•°ä¹Ÿå¯ä»¥æ¥æ”¶ä»»ä½•ç”Ÿå‘½å‘¨æœŸçš„å¼•ç”¨ã€‚ç”Ÿå‘½å‘¨æœŸå£°æ˜åªæè¿°äº†å¼•ç”¨ä¹‹é—´çš„ç”Ÿå‘½å‘¨æœŸå…³ç³»ï¼Œå¯¹è¿è¡Œæ—¶çœŸæ­£çš„ç”Ÿå‘½å‘¨æœŸæ²¡æœ‰å½±å“ã€‚</p> <p>æ³›å‹ç”Ÿå‘½å‘¨æœŸçš„å®šä¹‰è¯­æ³•æ¯”è¾ƒå¥‡æ€ªï¼šç”Ÿå‘½å‘¨æœŸå‚æ•°çš„åç§°å‰é¢ç”¨ä¸€ä¸ªå•å¼•å·<code>'</code>å¼€å¤´ï¼Œåç§°éƒ½æ˜¯å°å†™å­—æ¯ï¼Œå¹¶ä¸”åƒæ³›å‹å‚æ•°ä¸€æ ·åç§°é•¿åº¦å¾ˆçŸ­ã€‚æœ€å¸¸ç”¨çš„åç§°æ˜¯<code>'a</code>ã€‚æŠŠç”Ÿå‘½å‘¨æœŸå‚æ•°æ”¾åœ¨å¼•ç”¨çš„<code>&amp;</code>ç¬¦å·åé¢ï¼Œç”¨ç©ºæ ¼å°†ç±»å‹éš”å¼€ã€‚</p> <div class="language- extra-class"><pre><code>&amp;i32        // a reference
&amp;'a i32     // a reference with an explicit lifetime
&amp;'a mut i32 // a mutable reference with an explicit lifetime
</code></pre></div><p>å•ç‹¬çš„ç”Ÿå‘½å‘¨æœŸå£°æ˜æ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œå› ä¸ºå®ƒçš„ä½œç”¨æ˜¯å‘ŠçŸ¥ç¼–è¯‘å™¨å¼•ç”¨ä¹‹é—´çš„ç”Ÿå‘½å‘¨æœŸå…³ç³»ã€‚</p> <h3 id="åœ¨å‡½æ•°å£°æ˜ä¸­ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸå£°æ˜"><a href="#åœ¨å‡½æ•°å£°æ˜ä¸­ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸå£°æ˜" class="header-anchor">#</a> åœ¨å‡½æ•°å£°æ˜ä¸­ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸå£°æ˜</h3> <p>ç°åœ¨å¼€å§‹åœ¨<code>longest</code>å‡½æ•°ä¸Šä¸‹æ–‡ä¸­å®šä¹‰ç”Ÿå‘½å‘¨æœŸã€‚æ³›å‹ç”Ÿå‘½å‘¨æœŸå‚æ•°éœ€è¦åƒæ³›å‹ç±»å‹å‚æ•°ä¸€æ ·ï¼ŒåŒ…åœ¨<code>&lt;&gt;</code>ä¸­ã€‚ç”Ÿå‘½å‘¨æœŸå‚æ•°çš„å£°æ˜ä¸­æœ‰ä¸€æ¡é™åˆ¶æ˜¯ï¼Œæ‰€æœ‰çš„å‚æ•°å’Œè¿”å›å€¼å¿…é¡»è¦æœ‰ä¸€è‡´çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> longest<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> str<span class="token punctuation">,</span> y<span class="token punctuation">:</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> str<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> str <span class="token punctuation">{</span>
    <span class="token keyword">if</span> x<span class="token punctuation">.</span>len <span class="token operator">&gt;</span> y<span class="token punctuation">.</span>len <span class="token punctuation">{</span>
        x
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        y
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><code>longest</code>å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸”ç”Ÿå‘½å‘¨æœŸé•¿åº¦è‡³å°‘æ˜¯<code>'a</code>ï¼Œä¸”è¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸä¹Ÿæ˜¯<code>'a</code>ã€‚æ„å‘³ç€å‡½æ•°è¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸå’Œå‚æ•°ä¸­ç”Ÿå‘½å‘¨æœŸè¾ƒå°çš„é‚£ä¸ªç›¸ç­‰ã€‚è®°ä½ï¼Œå½“æˆ‘ä»¬å®šä¹‰å£°æ˜ç”Ÿå‘½å‘¨æœŸå‚æ•°æ—¶ï¼Œå¯¹å‚æ•°å’Œè¿”å›å€¼çœŸæ­£çš„ç”Ÿå‘½å‘¨æœŸæ²¡æœ‰ä»»ä½•å½±å“ã€‚å®ƒçš„ä½œç”¨æ˜¯æˆ‘ä»¬æŒ‡æ˜borrow checkeréœ€è¦æ‹’ç»ä¸ç¬¦åˆè¿™äº›é™åˆ¶çš„å‚æ•°ã€‚å‡½æ•°ä¸éœ€è¦çŸ¥é“å‚æ•°çš„ç¡®åˆ‡ç”Ÿå‘½å‘¨æœŸï¼Œåªéœ€è¦æŠŠå‡½æ•°å£°æ˜ä¸­ç¬¦åˆæ¡ä»¶çš„æœ€å°ç”Ÿå‘½å‘¨æœŸæ›¿æ¢ä¸º<code>'a</code>ã€‚</p> <p>å£°æ˜ç”Ÿå‘½å‘¨æœŸåªéœ€è¦åœ¨å‡½æ•°ç­¾åä¸­ï¼ŒRustå¯ä»¥è‡ªåŠ¨åˆ†æä»£ç ã€‚ç„¶è€Œå½“å‡½æ•°æœ‰å¤–éƒ¨ä»£ç æˆ–è€…å¼•ç”¨çš„æ—¶å€™ï¼ŒRustç¼–è¯‘å™¨å°±ä¸èƒ½é è‡ªå·±åˆ†æç”Ÿå‘½å‘¨æœŸäº†ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨æŒ‡å®šã€‚</p> <p><code>'a</code>æ³›å‹ç”Ÿå‘½å‘¨æœŸä¼šç­‰äºå‚æ•°<code>x</code>å’Œ<code>y</code>ä¸­ç”Ÿå‘½å‘¨æœŸè¾ƒå°çš„é‚£ä¸€ä¸ªã€‚å› ä¸ºæˆ‘ä»¬æŒ‡å®šè¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸä¹Ÿæ˜¯<code>'a</code>ï¼Œæ‰€ä»¥è¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸä¹Ÿå’Œ<code>x</code>å’Œ<code>y</code>ä¸­è¾ƒå°çš„é‚£ä¸€ä¸ªç›¸ç­‰ã€‚</p> <p>æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥çœ‹å½“å‚æ•°çœŸæ­£çš„ç”Ÿå‘½å‘¨æœŸä¸ç›¸ç­‰æ—¶ï¼Œç”Ÿå‘½å‘¨æœŸå‚æ•°å¦‚ä½•å¯¹å‡½æ•°åšé™åˆ¶ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> string1 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;long string is long&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">{</span>
        <span class="token keyword">let</span> string2 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;xyz&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">longest</span><span class="token punctuation">(</span>string1<span class="token punctuation">.</span><span class="token function">as_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> string2<span class="token punctuation">.</span><span class="token function">as_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The longest string is {}&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// output: The longest string is long string is long</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><code>string1</code>çš„ç”Ÿå‘½å‘¨æœŸæ˜¯å¤–éƒ¨ä½œç”¨åŸŸï¼ˆmainå‡½æ•°ï¼‰ã€‚<code>string2</code>çš„ç”Ÿå‘½å‘¨æœŸæ˜¯å†…éƒ¨ä½œç”¨åŸŸï¼ˆä»£ç å—ï¼‰ã€‚<code>result</code>å¼•ç”¨æŸä¸ªç©æ„å„¿ï¼Œç”Ÿå‘½å‘¨æœŸæ˜¯å†…éƒ¨ä½œç”¨åŸŸã€‚è¿™ä¸ªä»£ç èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œå¹¶è¾“å‡ºã€‚</p> <p>æ¥ä¸‹æ¥ï¼ŒæŠŠ<code>result</code>çš„å®šä¹‰å’Œ<code>println!</code>ç§»åˆ°å¤–éƒ¨ä½œç”¨åŸŸã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> string1 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;long string is long&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> result<span class="token punctuation">;</span>

    <span class="token punctuation">{</span>
        <span class="token keyword">let</span> string2 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;xyz&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token function">longest</span><span class="token punctuation">(</span>string1<span class="token punctuation">.</span><span class="token function">as_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> string2<span class="token punctuation">.</span><span class="token function">as_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The longest string is {}&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// error[E0597]: `string2` does not live long enough</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>è¿™æ—¶å€™ç¼–è¯‘ä¼šæŠ¥é”™ã€‚ä¹‹å‰æåˆ°è¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸç­‰äºå‚æ•°ç”Ÿå‘½å‘¨æœŸè¾ƒå°çš„é‚£ä¸ªï¼Œè¿™é‡Œä¹Ÿå°±æ˜¯<code>string2</code>ã€‚ä½†æ˜¯å½“<code>result</code>çš„å¼•ç”¨è¢«ä½¿ç”¨æ—¶ï¼Œ<code>string2</code>çš„ç”Ÿå‘½å‘¨æœŸå·²ç»ç»“æŸï¼Œå…¶å†…å­˜å·²ç»è¢«é‡Šæ”¾ï¼Œæ‰€ä»¥<code>result</code>æ˜¯ä¸€ä¸ªæ‚¬ç©ºæŒ‡é’ˆï¼ŒRustç¼–è¯‘å™¨ä¸ä¼šè®©è¿™ç§æƒ…å†µé€šè¿‡ç¼–è¯‘ã€‚</p> <p>è¿™ä¸ªé”™è¯¯è¡¨ç¤ºï¼Œ<code>result</code>è¦åœ¨<code>println!</code>å®è°ƒç”¨å®ƒçš„æ—¶å€™æœ‰æ•ˆï¼Œåˆ™<code>string2</code>å°±å¿…é¡»åœ¨å¤–éƒ¨ä½œç”¨åŸŸç»“æŸå‰æœ‰æ•ˆã€‚</p> <h3 id="thinking-in-terms-of-lifetimes"><a href="#thinking-in-terms-of-lifetimes" class="header-anchor">#</a> Thinking in Terms of Lifetimes</h3> <p>å®šä¹‰å‡½æ•°ç”Ÿå‘½å‘¨æœŸå‚æ•°çš„æ–¹å¼å–å†³äºå‡½æ•°çš„å…·ä½“åŠŸèƒ½ã€‚å¦‚æœä½ çš„å‡½æ•°ä»»ä½•æƒ…å†µä¸‹éƒ½è¿”å›ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦å¯¹ç¬¬äºŒä¸ªå‚æ•°è¿›è¡Œç”Ÿå‘½å‘¨æœŸå®šä¹‰ã€‚å› ä¸ºç¬¬äºŒä¸ªå‚æ•°ä¸ç¬¬ä¸€ä¸ªå‚æ•°æˆ–è€…è¿”å›å€¼æ²¡æœ‰ä»»ä½•ç”Ÿå‘½å‘¨æœŸå…³ç³»ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> longest<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> str<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> str <span class="token punctuation">{</span>
    x
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å½“å‡½æ•°è¿”å›ä¸€ä¸ªå¼•ç”¨æ—¶ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸè¦å’Œå‚æ•°åˆ—è¡¨å…¶ä¸­ä¸€ä¸ªå‚æ•°çš„ç”Ÿå‘½å‘¨æœŸåŒ¹é…ã€‚å¦‚æœå‡½æ•°çš„è¿”å›å€¼æ²¡æœ‰æŒ‡å‘ä»»ä½•å‚æ•°ï¼Œè€Œæ˜¯æŒ‡å‘ä¸€ä¸ªå‡½æ•°å†…éƒ¨åˆ›å»ºçš„å€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿”å›å€¼åœ¨å‡½æ•°ç»“æŸåä¼šæˆä¸ºä¸€ä¸ªæ‚¬ç©ºæŒ‡é’ˆã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> longest<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> str <span class="token punctuation">{</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;really long string&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    result<span class="token punctuation">.</span><span class="token function">as_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// error[E0515]: cannot return value referencing local variable `result`</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>å³ä½¿æˆ‘ä»¬å®šä¹‰äº†æ³›å‹ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼Œç¼–è¯‘å™¨è¿˜æ˜¯ä¸ä¼šé€šè¿‡è¿™ä¸ªä»£ç ï¼Œå› ä¸ºè¿”å›å€¼æœ¬è´¨ä¸Šå’Œå‚æ•°æ²¡æœ‰ä»»ä½•å…³è”ã€‚</p> <p>æ€»ä¹‹ï¼Œç”Ÿå‘½å‘¨æœŸè¯­æ³•éœ€è¦å‡½æ•°å‚æ•°å’Œè¿”å›å€¼ä¹‹é—´æœ‰æ‰€å…³è”ã€‚åªæœ‰è¿™æ ·Rustç¼–è¯‘å™¨æ‰æœ‰è¶³å¤Ÿçš„åˆ¤æ–­ä¾æ®æ¥å…è®¸æ‰§è¡Œå†…å­˜å®‰å…¨çš„æ“ä½œå’Œç¦æ­¢ä»»ä½•å¯èƒ½åˆ›å»ºæ‚¬ç©ºæŒ‡é’ˆçš„æ“ä½œã€‚</p> <h3 id="lifetime-annotations-in-struct-definitions"><a href="#lifetime-annotations-in-struct-definitions" class="header-anchor">#</a> Lifetime Annotations in Struct Definitions</h3> <p>è‡³ä»Šæˆ‘ä»¬å®šä¹‰çš„ç»“æ„ä½“å­—æ®µéƒ½æ˜¯æœ‰æ‰€æœ‰æƒçš„ï¼Œç»“æ„ä½“å­—æ®µä¹Ÿå¯ä»¥åŒ…å«å¼•ç”¨ã€‚å½“ç»“æ„ä½“å­—æ®µåŒ…å«å¼•ç”¨çš„æ—¶å€™ï¼Œéœ€è¦å¯¹æ¯ä¸ªå¼•ç”¨ç±»å‹çš„å­—æ®µå®šä¹‰ç”Ÿå‘½å‘¨æœŸã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">struct</span> ImportantExcerpt<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    part<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> str<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> novel <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Call me Ishmael. Some years ago...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> first_sentence <span class="token operator">=</span> novel<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token char string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Could not find a '.'&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> i <span class="token operator">=</span> ImportantExcerpt <span class="token punctuation">{</span>
        part<span class="token punctuation">:</span> first_sentence<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>è¿™ä¸ªç»“æ„ä½“æœ‰ä¸€ä¸ªå­—æ®µ<code>part</code>ï¼Œå­˜å‚¨ä¸€ä¸ª<code>&amp;str</code>ç±»å‹çš„æ•°æ®ã€‚æ³›å‹ç”Ÿå‘½å‘¨æœŸå‚æ•°ç”¨<code>&lt;&gt;</code>åŒ…èµ·æ¥ï¼Œæ”¾åœ¨ç»“æ„ä½“åç§°å’Œç»“æ„ä½“ä»£ç å—ä¹‹é—´ã€‚è¿™ä¸ªå®šä¹‰æ„å‘³ç€ï¼Œ<code>ImportantExcerpt</code>ç±»å‹çš„å®ä¾‹ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸä¸è¶…è¿‡<code>part</code>å­—æ®µå¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€‚</p> <p><code>main</code>æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ª<code>ImportantExcerpt</code>å®ä¾‹ï¼Œå¹¶ä¸”å°†<code>novel</code>å˜é‡çš„éƒ¨åˆ†å¼•ç”¨èµ‹å€¼ç»™å®ä¾‹çš„å­—æ®µã€‚<code>novel</code>åœ¨å®ä¾‹åˆ›å»ºä¹‹å‰åˆå§‹åŒ–ï¼Œè€Œä¸”<code>novel</code>åœ¨ä½œç”¨åŸŸæ‰§è¡Œç»“æŸï¼Œå®ä¾‹è¢«é‡Šæ”¾åæ‰ä¼šè¢«é‡Šæ”¾ï¼Œå› æ­¤å®ä¾‹ä¸­çš„å¼•ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚</p> <h3 id="lifetime-elision"><a href="#lifetime-elision" class="header-anchor">#</a> Lifetime Elision</h3> <p>ç°åœ¨äº†è§£äº†æ‰€æœ‰çš„å¼•ç”¨éƒ½æœ‰ç”Ÿå‘½å‘¨æœŸï¼Œè€Œä¸”ä½ éœ€è¦ä¸ºä½¿ç”¨äº†å¼•ç”¨çš„ç»“æ„ä½“å’Œå‡½æ•°å£°æ˜ç”Ÿå‘½å‘¨æœŸå‚æ•°ã€‚ä¹‹å‰æˆ‘ä»¬å†™è¿‡ä¸€ä¸ªè·å–å¥å­ä¸­ç¬¬ä¸€ä¸ªå•è¯çš„<a href="/Rust-Book/Rust/2-ownership.html#section-3-the-slice-type">æ–¹æ³•</a>ï¼Œè¿™ä¸ªå‡½æ•°æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸå£°æ˜ï¼Œè€Œä¸”ç¼–è¯‘é€šè¿‡äº†ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function">first_word</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span>str <span class="token punctuation">{</span>
    <span class="token keyword">let</span> bytes <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">as_bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token operator">&amp;</span>item<span class="token punctuation">)</span> <span class="token keyword">in</span> bytes<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> item <span class="token operator">==</span> <span class="token char string">b' '</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>è¿™ä¸ªå‡½æ•°æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸå£°æ˜ä½†æ˜¯ç¼–è¯‘é€šè¿‡æ˜¯å› ä¸ºä¸€äº›å†å²åŸå› ï¼šæ—©èµ·çš„Rustç‰ˆæœ¬ï¼ˆ&lt;1.0ï¼‰ä¸­ï¼Œè¿™ä¸ªä»£ç æ˜¯ä¸èƒ½ç¼–è¯‘é€šè¿‡çš„ï¼Œå› ä¸ºè¦æ±‚æ‰€æœ‰å¼•ç”¨éƒ½å£°æ˜å£°æ˜å‘¨æœŸã€‚åœ¨é‚£ä¸ªç‰ˆæœ¬ä¸‹ï¼Œè¿™ä¸ªå‡½æ•°çš„ç­¾åæ˜¯</p> <blockquote><p><code>fn first_word&lt;'a&gt;(s: &amp;'a str) -&gt; &amp;'a str {</code></p></blockquote> <p>åœ¨ç¼–å†™äº†å¤§é‡çš„Rustä»£ç ä¹‹åï¼ŒRustæ ¸å¿ƒå›¢é˜Ÿå‘ç°ï¼ŒRustç¨‹åºå‘˜åœ¨ä¸€äº›ç‰¹å®šåœºæ™¯ä¸‹éœ€è¦ä¸€ç›´é‡å¤åŒæ ·çš„ç”Ÿå‘½å‘¨æœŸå£°æ˜ã€‚è¿™äº›åœºæ™¯æ˜¯å¯é¢„æµ‹è€Œä¸”éµå¾ªç‰¹å®šçš„æ¨¡å¼çš„ã€‚ç»´æŠ¤è€…å°†è¿™äº›æ¨¡å¼åŠ å…¥ç¼–è¯‘å™¨ï¼Œè¿™æ ·ç¼–è¯‘å™¨å°±èƒ½å¯¹è¿™äº›åœºæ™¯è¿›è¡Œç”Ÿå‘½å‘¨æœŸæ¨æ–­ï¼Œè€Œä¸éœ€è¦ç¨‹åºå‘˜æ˜¾å¼æŒ‡å®šäº†ã€‚</p> <p>ä»Šåå¯èƒ½è¿˜ä¼šå‡ºç°å…¶ä»–ç‰¹å®šçš„æ¨¡å¼ï¼Œç„¶åè¢«åŠ å…¥åˆ°ç¼–è¯‘å™¨ä¸­ã€‚ä»¥åéœ€è¦æŒ‡å®šç”Ÿå‘½å‘¨æœŸçš„åœºæ™¯å¯èƒ½ä¼šè¶Šæ¥è¶Šå°‘ã€‚</p> <p>è¿™äº›ç”¨æ¥åˆ†æå¼•ç”¨ç”Ÿå‘½å‘¨æœŸï¼Œè¢«ç¼–å†™è¿›Rustç¼–è¯‘å™¨çš„æ¨¡å¼è¢«ç§°ä¸º<em>ç”Ÿå‘½å‘¨æœŸçœç•¥è§„åˆ™ï¼ˆlifetime elision rulesï¼‰</em>ã€‚è¿™ä¸æ˜¯ç»™ç¨‹åºå‘˜æŒ‡å®šçš„è§„åˆ™ï¼Œè€Œæ˜¯ç¼–è¯‘å™¨çš„ä¸€ä¸ªè§„åˆ™é›†åˆï¼Œç¼–è¯‘å™¨é€šè¿‡è¿™ä¸ªé›†åˆåˆ¤æ–­å¦‚æœä½ çš„ä»£ç åœºæ™¯ç¬¦åˆå…¶ä¸­çš„æŸä¸ªæ¨¡å¼ï¼Œé‚£ä¹ˆå°±ä¸ç”¨æ˜¾å¼å£°æ˜ç”Ÿå‘½å‘¨æœŸã€‚</p> <p>å‡½æ•°å‚æ•°çš„ç”Ÿå‘½å‘¨æœŸç§°ä¸º<em>input lifetimes</em>ï¼Œå‡½æ•°è¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸç§°ä¸º<em>output lifetimes</em></p> <p>å½“æ²¡æœ‰æŒ‡å®šç”Ÿå‘½å‘¨æœŸæ—¶ï¼Œç¼–è¯‘å™¨é€šè¿‡ä¸‰ä¸ªè§„åˆ™æ¥åˆ¤æ–­å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€‚è§„åˆ™ä¸€é€‚ç”¨äº<em>input lifetimes</em>ï¼Œè§„åˆ™äºŒä¸‰é€‚ç”¨äº<em>output lifetimes</em>ã€‚å¦‚æœé€šè¿‡ä¸‰æ¡è§„åˆ™ç¼–è¯‘å™¨éƒ½ä¸èƒ½ç¡®å®šå¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸï¼Œåˆ™ä¼šæŠ¥é”™é€€å‡ºã€‚è¿™ä¸‰æ¡è§„åˆ™åŒæ—¶é€‚ç”¨äº<code>fn</code>å£°æ˜å’Œ<code>impl</code>å£°æ˜ã€‚</p> <ul><li>è§„åˆ™ä¸€ï¼šæ¯ä¸ªå¼•ç”¨å‚æ•°éƒ½æœ‰å®ƒè‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸã€‚å³ï¼Œä¸€ä¸ªå‚æ•°çš„å‡½æ•°å¯ä»¥è·å–åˆ°ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸ<code>fn foo&lt;'a&gt;(x: &amp;'a i32)</code>ï¼Œä¸¤ä¸ªå‚æ•°çš„å‡½æ•°è·å–åˆ°ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸ<code>fn foo&lt;'a, 'b&gt;(x: &amp;'a i32, y: &amp;'b i32)</code>ã€‚ä¾æ­¤ç±»æ¨ã€‚</li> <li>è§„åˆ™äºŒï¼šå¦‚æœæ˜ç¡®åªæœ‰ä¸€ä¸ªinput lifetimeå‚æ•°ï¼Œé‚£ä¹ˆoutput lifetimeè·Ÿå®ƒç›¸åŒã€‚<code>fn foo&lt;'a&gt;(x: &amp;'a i32) -&gt; &amp;'a i32</code>ã€‚</li> <li>è§„åˆ™ä¸‰ï¼šå¦‚æœæœ‰å¤šä¸ªinput lifetimeå‚æ•°ï¼Œä½†æ˜¯å…¶ä¸­ä¹‹ä¸€æ˜¯<code>&amp;self</code>æˆ–è€…<code>&amp;mut self</code>ï¼Œé‚£ä¹ˆæ‰€æœ‰output lifetimeséƒ½è·Ÿ<code>self</code>çš„ç”Ÿå‘½å‘¨æœŸç›¸åŒã€‚</li></ul> <p>æˆ‘ä»¬åœ¨ç¼–è¯‘å™¨çš„è§’åº¦çœ‹å‡ ä¸ªå‡½æ•°ç­¾åã€‚</p> <blockquote><p><code>fn first_word(s: &amp;str) -&gt; &amp;str {</code></p></blockquote> <p>é¦–å…ˆåº”ç”¨è§„åˆ™ä¸€ï¼Œæ¯ä¸ªå‚æ•°éƒ½æœ‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸã€‚</p> <blockquote><p><code>fn first_word&lt;'a&gt;(s:&amp;'a str) -&gt; &amp;str {</code></p></blockquote> <p>æ¥ç€è§„åˆ™äºŒä¹Ÿç¬¦åˆï¼šåªæœ‰ä¸€ä¸ªå‚ï¼Œé‚£ä¹ˆè¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸä¹Ÿç¡®å®šäº†</p> <blockquote><p><code>fn first_word&lt;'a&gt;(s:&amp;'a str) -&gt; &amp;'a str {</code></p></blockquote> <p>åœ¨çœ‹å¦å¤–ä¸€ä¸ªä¾‹å­ï¼š</p> <blockquote><p><code>fn longest(x: &amp;str, y: &amp;str) -&gt; &amp;str {</code></p></blockquote> <p>é¦–å…ˆè§„åˆ™ä¸€ï¼š</p> <blockquote><p><code>fn longest&lt;'a, 'b&gt;(x: &amp;'a str, y: &amp;'b str) -&gt; &amp;str {</code></p></blockquote> <p>æ¥ä¸‹æ¥è§„åˆ™äºŒä¸é€‚ç”¨ï¼Œå› ä¸ºæœ‰ä¸¤ä¸ªå‚æ•°ï¼›è§„åˆ™ä¸‰ä¹Ÿä¸é€‚ç”¨ï¼Œå› ä¸ºå®ƒä¸æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œæ²¡æœ‰<code>self</code>å‚æ•°ã€‚ä¸‰æ¡è§„åˆ™ç»“æŸï¼Œè¿˜æ²¡èƒ½ç¡®å®šè¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ­¤æ—¶ç¼–è¯‘å™¨æŠ¥é”™é€€å‡ºã€‚</p> <h3 id="lifetime-annotations-in-method-definitions"><a href="#lifetime-annotations-in-method-definitions" class="header-anchor">#</a> Lifetime Annotations in Method Definitions</h3> <p>å½“æˆ‘ä»¬å®ç°æ–¹æ³•å½“æ—¶å€™å£°æ˜å…¶ç”Ÿå‘½å‘¨æœŸæ—¶ï¼Œå®ƒçš„å®šä¹‰æ–¹å¼å’Œæ³›å‹ç±»å‹ä¸€æ ·ã€‚æˆ‘ä»¬åœ¨ä½•å¤„å®šä¹‰å’Œä½¿ç”¨ç”Ÿå‘½å‘¨æœŸå‚æ•°å–å†³äºä»–ä»¬æ˜¯å¦å’Œæ–¹æ³•çš„å‚æ•°æˆ–è€…å®ä¾‹å­—æ®µä»¥åŠè¿”å›å€¼ç›¸å…³ã€‚ç»“æ„ä½“å­—æ®µçš„ç”Ÿå‘½å‘¨æœŸåç§°ä»»ä½•æƒ…å†µä¸‹éƒ½éœ€è¦åœ¨<code>impl</code>å…³é”®å­—åå£°æ˜å’Œåœ¨ç»“æ„ä½“åç§°ä¸­ä½¿ç”¨ï¼Œå› ä¸ºå®ƒæ˜¯ç»“æ„ä½“å£°æ˜çš„ä¸€éƒ¨åˆ†ã€‚</p> <p>åœ¨æ–¹æ³•ç­¾åä¸­ï¼Œå¼•ç”¨å¯èƒ½ä¼šè·Ÿå®ä¾‹å­—æ®µçš„ç”Ÿå‘½å‘¨æœŸç»‘å®šï¼Œä¹Ÿå¯èƒ½æ˜¯ç‹¬ç«‹çš„ã€‚æ­¤å¤–ï¼Œ<em>ç”Ÿå‘½å‘¨æœŸçœç•¥è§„åˆ™</em>é€šå¸¸ä½¿æ–¹æ³•ç”Ÿå‘½ä¸­ä¸éœ€è¦å®šä¹‰ç”Ÿå‘½å‘¨æœŸã€‚</p> <p>é€šè¿‡ä¹‹å‰çš„<code>ImportantExcerpt</code>ç»“æ„ä½“æ¥çœ‹ä¸€äº›ä¾‹å­ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span> ImportantExcerpt<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function">level</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> i32 <span class="token punctuation">{</span>
        <span class="token number">3</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>åœ¨<code>impl</code>åå£°æ˜ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼Œåœ¨ç»“æ„ä½“åç§°åä½¿ç”¨æ˜¯å¿…é¡»çš„ã€‚ä½†æ˜¯ç”±äºç”Ÿå‘½å‘¨æœŸçœç•¥è§„åˆ™ä¸€ï¼Œä¸éœ€è¦åœ¨æ–¹æ³•ç­¾åä¸­å£°æ˜ç”Ÿå‘½å‘¨æœŸã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span> ImportantExcerpt<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function">announce_and_return_part</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> announcement<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span>str <span class="token punctuation">{</span>
        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Attention please: {}&quot;</span><span class="token punctuation">,</span> announcement<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>part
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>ä¸Šé¢æ˜¯ä¸€ä¸ªç¬¦åˆç”Ÿå‘½å‘¨æœŸçœç•¥è§„åˆ™ä¸‰çš„ä¾‹å­ã€‚</p> <h3 id="the-static-lifetime"><a href="#the-static-lifetime" class="header-anchor">#</a> The Static Lifetime</h3> <p>ä¸€ä¸ªéœ€è¦è¯´æ˜çš„ç‰¹æ®Šç”Ÿå‘½å‘¨æœŸæ˜¯<code>static</code>ï¼Œæ„æ€æ˜¯å¼•ç”¨åœ¨æ•´ä¸ªç¨‹åºæ‰§è¡ŒæœŸé—´éƒ½æœ‰æ•ˆã€‚å­—ç¬¦ä¸²å­—é¢é‡çš„ç”Ÿå‘½å‘¨æœŸéƒ½æ˜¯<code>static</code>ï¼š</p> <blockquote><p><code>let s: &amp;'static str = &quot;I have a static lifetime.&quot;;</code></p></blockquote> <p>å› ä¸ºå­—ç¬¦ä¸²å­—é¢é‡æ˜¯ç›´æ¥å†™å…¥å¯æ‰§è¡Œæ–‡ä»¶çš„ï¼Œç¨‹åºè¿è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨ï¼Œæ‰€ä»¥å®ƒçš„ç”Ÿå‘½å‘¨æœŸæ˜¯<code>static</code>ã€‚</p> <p>å¯èƒ½åœ¨æŠ¥é”™æ—¶ä½ ä¼šçœ‹åˆ°ç¼–è¯‘å™¨å»ºè®®ä½ ä½¿ç”¨<code>static</code>ç”Ÿå‘½å‘¨æœŸã€‚ä½†æ˜¯è¿™äº›é—®é¢˜å¯èƒ½æ˜¯ç”±äºåˆ›å»ºæ‚¬ç©ºæŒ‡é’ˆæˆ–è€…ç”Ÿå‘½å‘¨æœŸä¸åŒ¹é…é€ æˆçš„ï¼Œé¦–å…ˆåº”å½“è§£å†³çœŸæ­£çš„é—®é¢˜è€Œä¸æ˜¯æ— è„‘<code>static</code>ã€‚</p> <h2 id="section-4-generic-type-parameters-trait-bounds-and-lifetimes-together"><a href="#section-4-generic-type-parameters-trait-bounds-and-lifetimes-together" class="header-anchor">#</a> Section 4 - Generic Type Parameters, Trait Bounds, and Lifetimes Together</h2> <p>è®©æˆ‘ä»¬æŠŠè¿™ä¸‰ä¸ªæ¦‚å¿µä½¿ç”¨åœ¨ä¸€ä¸ªå‡½æ•°å®šä¹‰ä¸­ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">use</span> std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span>Display<span class="token punctuation">;</span>

<span class="token keyword">fn</span> longest_with_an_announcement<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a,</span> T<span class="token operator">&gt;</span><span class="token punctuation">(</span>
    x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> str<span class="token punctuation">,</span>
    y<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> str<span class="token punctuation">,</span>
    ann<span class="token punctuation">:</span> T<span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> str
<span class="token keyword">where</span>
    T<span class="token punctuation">:</span> Display<span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Announcement! {}&quot;</span><span class="token punctuation">,</span> ann<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> x<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> y<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        x
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        y
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.6f46cf57.js" defer></script><script src="/assets/js/2.49ce1412.js" defer></script><script src="/assets/js/13.beaf8085.js" defer></script>
  </body>
</html>
