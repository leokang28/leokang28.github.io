<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Chapter 7 - Error Handling | KSLEO</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="Just playing around">
    <link rel="preload" href="/assets/css/0.styles.35aebc44.css" as="style"><link rel="preload" href="/assets/js/app.6f46cf57.js" as="script"><link rel="preload" href="/assets/js/2.49ce1412.js" as="script"><link rel="preload" href="/assets/js/12.14d347b9.js" as="script"><link rel="prefetch" href="/assets/js/10.86ad4e85.js"><link rel="prefetch" href="/assets/js/11.e7ef91a0.js"><link rel="prefetch" href="/assets/js/13.beaf8085.js"><link rel="prefetch" href="/assets/js/14.e42e08a4.js"><link rel="prefetch" href="/assets/js/15.41e8c95f.js"><link rel="prefetch" href="/assets/js/16.e8b84c5d.js"><link rel="prefetch" href="/assets/js/17.4d574f20.js"><link rel="prefetch" href="/assets/js/18.a8a8e164.js"><link rel="prefetch" href="/assets/js/19.118b3a66.js"><link rel="prefetch" href="/assets/js/20.ccdc0717.js"><link rel="prefetch" href="/assets/js/21.88ceead5.js"><link rel="prefetch" href="/assets/js/22.500d3be7.js"><link rel="prefetch" href="/assets/js/23.b7ca339b.js"><link rel="prefetch" href="/assets/js/24.0360313a.js"><link rel="prefetch" href="/assets/js/25.6083b636.js"><link rel="prefetch" href="/assets/js/26.1bd9d3eb.js"><link rel="prefetch" href="/assets/js/27.beb716dd.js"><link rel="prefetch" href="/assets/js/28.bb093ca6.js"><link rel="prefetch" href="/assets/js/29.5b527549.js"><link rel="prefetch" href="/assets/js/3.8a6c11df.js"><link rel="prefetch" href="/assets/js/30.796276de.js"><link rel="prefetch" href="/assets/js/31.666b101e.js"><link rel="prefetch" href="/assets/js/32.654129d9.js"><link rel="prefetch" href="/assets/js/33.e479db51.js"><link rel="prefetch" href="/assets/js/4.e2a8d64a.js"><link rel="prefetch" href="/assets/js/5.dd4c966a.js"><link rel="prefetch" href="/assets/js/6.00a6c78e.js"><link rel="prefetch" href="/assets/js/7.9330d48e.js"><link rel="prefetch" href="/assets/js/8.560dd961.js"><link rel="prefetch" href="/assets/js/9.da6c1180.js">
    <link rel="stylesheet" href="/assets/css/0.styles.35aebc44.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">KSLEO</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/directory/" class="nav-link">
  ç¬”è®°ğŸ“’
</a></div><div class="nav-item"><a href="http://leokang28.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  åšå®¢ğŸ”—
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/directory/" class="nav-link">
  ç¬”è®°ğŸ“’
</a></div><div class="nav-item"><a href="http://leokang28.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  åšå®¢ğŸ”—
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="chapter-7-error-handling"><a href="#chapter-7-error-handling" class="header-anchor">#</a> Chapter 7 - Error Handling</h1> <p>Rustçš„å¯é æ€§ä¹‹ä¸€å°±åœ¨äºå®ƒçš„é”™è¯¯å¤„ç†ã€‚åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼ŒRustè¦æ±‚ä½ åœ¨ä»£ç ç¼–è¯‘ä¹‹å‰å¯¹æ‰€æœ‰å¯èƒ½çš„é”™è¯¯æƒ…å†µè¿›è¡Œå¤„ç†ã€‚åœ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¹‹å‰ç¡®ä¿å‘ç°å¹¶å¤„ç†é”™è¯¯ï¼Œè¿™è®©ä½ çš„ä»£ç å¥å£®æ€§æ›´å¼ºã€‚</p> <p>Rustå°†é”™è¯¯åˆ†ä¸ºä¸¤ä¸ªå¤§ç±»ï¼š<em>recoverable</em>å’Œ<em>unrecoverable</em>ã€‚å‰è€…ä¾‹å¦‚è¯»å–ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œå°†è¯¥é”™è¯¯ä¸ŠæŠ¥å¹¶ä¸”é‡è¯•è¿™ä¸ªæ“ä½œæ˜¯åˆç†çš„è¡Œä¸ºã€‚åè€…ä¸€åŠæ˜¯ç”±äºä»£ç é€»è¾‘bugï¼Œä¾‹å¦‚æ•°ç»„è¶Šç•Œè®¿é—®ã€‚</p> <p>å¤§å¤šæ•°è¯­è¨€ä¸ä¼šå¯¹è¿™ä¸¤ä¸ªå¤§ç±»è¿›è¡ŒåŒºåˆ†ï¼Œä¸€èˆ¬éƒ½æ˜¯é‡‡ç”¨åŒä¸€å¥—è§£å†³æ–¹å¼ï¼Œä¾‹å¦‚å¼‚å¸¸æœºåˆ¶ã€‚Rustæ²¡æœ‰å¼‚å¸¸æœºåˆ¶ï¼ŒRustç”¨<code>Result&lt;U,E&gt;</code>å¤„ç†recoverableç±»å‹çš„é”™è¯¯ï¼Œç”¨<code>panic!</code>å®å¤„ç†unrecoverableç±»å‹çš„é”™è¯¯ã€‚</p> <h2 id="section-1-unrecoverable-errors-with-panic"><a href="#section-1-unrecoverable-errors-with-panic" class="header-anchor">#</a> Section 1 - Unrecoverable Errors with panic!</h2> <p>å½“å‡ºç°ä¸€äº›æ„æ–™ä¹‹å¤–çš„é”™è¯¯ï¼Œå¹¶ä¸”æ²¡æœ‰åç»­çš„å¤„ç†é€»è¾‘æˆ–è€…ä¸çŸ¥é“è¯¥å¦‚ä½•å¤„ç†æ—¶ï¼ŒRustæœ‰<code>panic!</code>å®ã€‚å½“<code>panic!</code>å®è°ƒç”¨æ—¶ï¼Œæ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ï¼Œç„¶åé‡Šæ”¾æ¸…ç©ºå †æ ˆå†…å­˜é€€å‡ºç¨‹åºã€‚</p> <details class="custom-block details"><summary>Unwinding the Stack or Aborting in Response to a Panic</summary> <p>ä¸€èˆ¬æ¥è¯´ï¼Œå½“panicå‘ç”Ÿåï¼ŒRustä¼šè¿›å…¥<em>unwinding</em>é˜¶æ®µï¼Œå®ƒéœ€è¦åˆ°å †æ ˆé¡¶éƒ¨ï¼Œå¼€å§‹éå†å †æ ˆæ¸…ç©ºæ•°æ®å’Œå‡½æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆè´¹æ—¶çš„æ“ä½œã€‚å¦ä¸€ç§æ–¹æ¡ˆæ˜¯<em>abort</em>ï¼Œå³ç¨‹åºé€€å‡ºæ—¶Rustä¸ä¼šæ¸…ç©ºå †æ ˆï¼Œè€Œå°†è¿™ä¸ªæ“ä½œäº¤ç»™æ“ä½œç³»ç»Ÿã€‚å¦‚æœä½ éœ€è¦ä½ çš„é¡¹ç›®ç¼–è¯‘ç»“æœå°½å¯èƒ½å°ï¼Œä½ å¯ä»¥é€šè¿‡è®¾ç½®<em>Cargo.toml</em>æ–‡ä»¶æ¥è®©ä½ çš„ç¨‹åºä¸ºabortæ¨¡å¼ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token punctuation">[</span>profile<span class="token punctuation">.</span>release<span class="token punctuation">]</span>
panic <span class="token operator">=</span> <span class="token lifetime-annotation symbol">'abort</span>'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></details> <p>ä¸‹é¢ç®€å•è°ƒç”¨ä¸€ä¸‹<code>panic!</code>å®æ¥çœ‹ä¸€çœ‹å®ƒçš„è¾“å‡ºã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token string">&quot;crash&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// thread 'main' panicked at 'crash', src/main.rs:17:9</span>
<span class="token comment">// note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>å¯ä»¥çœ‹åˆ°<code>panic!</code>è¾“å‡ºäº†ä¸¤è¡Œä¿¡æ¯ï¼Œç¬¬ä¸€è¡Œæ˜¯é”™è¯¯ä¿¡æ¯å’Œé”™è¯¯åœ¨æºä»£ç åœ¨æ–‡ä»¶ä¸­çš„ä½ç½®ã€‚</p> <p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è·Ÿè¸ªä»£ç åœ¨å¯¹åº”çš„ä½ç½®æ‰¾åˆ°å¯¼è‡´<code>panic!</code>å®è°ƒç”¨çš„ä»£ç ã€‚</p> <h3 id="using-a-panic-backtrace"><a href="#using-a-panic-backtrace" class="header-anchor">#</a> Using a <code>panic!</code> Backtrace</h3> <p>æˆ‘ä»¬å¯ä»¥è®¾ç½®<code>RUST_BACKTRACE</code>ç¯å¢ƒå˜é‡æ¥è·å–å‘ç”Ÿé”™è¯¯çš„å®Œæ•´è°ƒç”¨é“¾è·¯ã€‚å®ƒæ˜¯ä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨å †æ ˆåˆ—è¡¨ï¼Œä»æ ˆé¡¶å¼€å§‹ä¸€ç›´åˆ°æˆ‘ä»¬è‡ªå·±çš„ä»£ç æ–‡ä»¶ã€‚è¿™ä¸ªé“¾è·¯ä¸­å¯èƒ½åŒ…å«æ ¸å¿ƒæ–‡ä»¶ã€æ ‡å‡†åº“æ–‡ä»¶ã€å…¶ä»–ä½ ä½¿ç”¨åˆ°çš„ç¬¬ä¸‰æ–¹æ¨¡å—ä»£ç ã€‚ä½ æ‰€åœ¨æ–‡ä»¶é‚£ä¸€è¡Œä¸Šé¢çš„å†…å®¹æ˜¯ä½ çš„ä»£ç è°ƒç”¨çš„æ–‡ä»¶ï¼Œä¸‹é¢çš„å†…å®¹æ˜¯è°ƒç”¨ä½ ä»£ç çš„æ–‡ä»¶ã€‚</p> <div class="language- extra-class"><pre><code>stack backtrace:
    0: backtrace::backtrace::libunwind::trace
                at /Users/runner/.cargo/registry/src/github.com-1ecc6299db9ec823/backtrace-0.3.46/src/backtrace/libunwind.rs:86
    1: backtrace::backtrace::trace_unsynchronized
                at /Users/runner/.cargo/registry/src/github.com-1ecc6299db9ec823/backtrace-0.3.46/src/backtrace/mod.rs:66
    2: std::sys_common::backtrace::_print_fmt
                at src/libstd/sys_common/backtrace.rs:78
    3: &lt;std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display&gt;::fmt
                at src/libstd/sys_common/backtrace.rs:59
    4: core::fmt::write
                at src/libcore/fmt/mod.rs:1076
    5: std::io::Write::write_fmt
                at src/libstd/io/mod.rs:1537
    6: std::sys_common::backtrace::_print
                at src/libstd/sys_common/backtrace.rs:62
    7: std::sys_common::backtrace::print
                at src/libstd/sys_common/backtrace.rs:49
    8: std::panicking::default_hook::
                at src/libstd/panicking.rs:198
    9: std::panicking::default_hook
                at src/libstd/panicking.rs:218
    10: std::panicking::rust_panic_with_hook
                at src/libstd/panicking.rs:486
    11: rust_begin_unwind
                at src/libstd/panicking.rs:388
    12: core::panicking::panic_fmt
                at src/libcore/panicking.rs:101
    13: core::panicking::panic_bounds_check
                at src/libcore/panicking.rs:73
    14: &lt;usize as core::slice::SliceIndex&lt;[T]&gt;&gt;::index
                at /Users/ksleo/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/src/rust/src/libcore/slice/mod.rs:2872
    15: core::slice::&lt;impl core::ops::index::Index&lt;I&gt; for [T]&gt;::index
                at /Users/ksleo/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/src/rust/src/libcore/slice/mod.rs:2732
    16: &lt;alloc::vec::Vec&lt;T&gt; as core::ops::index::Index&lt;I&gt;&gt;::index
                at /Users/ksleo/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/src/rust/src/liballoc/vec.rs:1942
    17: p::main
                at src/main.rs:5
    18: std::rt::lang_start::
                at /Users/ksleo/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/src/rust/src/libstd/rt.rs:67
    19: std::rt::lang_start_internal::
                at src/libstd/rt.rs:52
    20: std::panicking::try::do_call
                at src/libstd/panicking.rs:297
    21: std::panicking::try
                at src/libstd/panicking.rs:274
    22: std::panic::catch_unwind
                at src/libstd/panic.rs:394
    23: std::rt::lang_start_internal
                at src/libstd/rt.rs:51
    24: std::rt::lang_start
                at /Users/ksleo/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/src/rust/src/libstd/rt.rs:67
    25: main
</code></pre></div><p>ä¸ºäº†è·å–è¿™ä¸ªè¾“å‡ºï¼Œdebugæ ‡è¯†å¿…é¡»æ˜¯enableçš„ï¼Œåœ¨è¿è¡Œ<code>cargo build</code>æˆ–è€…<code>cargo run</code>çš„å¹¶ä¸”ä¸å¸¦<code>--release</code>é€‰é¡¹çš„æ—¶å€™ï¼Œè¯¥æ ‡è¯†é»˜è®¤æ˜¯enableçš„ã€‚å…·ä½“çš„è¾“å‡ºå†…å®¹å’Œä½ çš„æ“ä½œç³»ç»Ÿä»¥åŠRustç‰ˆæœ¬æœ‰å…³ã€‚</p> <h2 id="section-2-recoverable-errors-with-result"><a href="#section-2-recoverable-errors-with-result" class="header-anchor">#</a> Section 2 - Recoverable Errors with <code>Result</code></h2> <p>å¤§å¤šæ•°é”™è¯¯æŠ›å‡ºçš„æ—¶å€™ï¼Œéƒ½æ²¡æœ‰å¿…è¦å°†ç¨‹åºé€€å‡ºã€‚æ¯”å¦‚ï¼Œå½“è¯»å–çš„æ–‡ä»¶ä¸å­˜åœ¨æ—¶ï¼Œå¯ä»¥è€ƒè™‘åˆ›å»ºè¯¥æ–‡ä»¶è€Œä¸æ˜¯ç»ˆæ­¢è¿›ç¨‹ã€‚</p> <p><code>Result</code>æšä¸¾æœ‰ä¸¤ä¸ªå€¼ï¼Œ<code>Ok</code>å’Œ<code>Err</code>ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">enum</span> Result<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> E<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">Ok</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">Err</span><span class="token punctuation">(</span>E<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Tå’ŒEæ˜¯æ³›å‹å˜é‡ã€‚Tä»£è¡¨æˆåŠŸæƒ…å†µä¸‹è¿”å›å€¼çš„ç±»å‹ï¼ŒEä»£è¡¨å¤±è´¥æƒ…å†µä¸‹é”™è¯¯çš„è¿”å›ç±»å‹ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">use</span> std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span>File<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> f <span class="token operator">=</span> File<span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>å¦‚ä½•çŸ¥é“<code>File::open</code>å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ª<code>Result</code>æšä¸¾å‘¢ï¼Ÿä¸€ç§æ–¹å¼æ˜¯æŸ¥çœ‹æ ‡å‡†åº“APIæ–‡æ¡£ï¼Œå¦å¤–ä¸€ç§æ–¹å¼æ˜¯ç»™å˜é‡<code>f</code>æŒ‡å®šä¸€ä¸ªå…¶ä»–çš„æ•°æ®ç±»å‹ã€‚ç„¶åç¼–è¯‘ä»£ç ï¼Œç¼–è¯‘å™¨ä¼šç»™å‡ºç±»å‹ä¸åŒ¹é…çš„é”™è¯¯ä¿¡æ¯ã€‚</p> <p>è¿™é‡Œæ³›å‹å˜é‡<code>T</code>ä¼šè¢«å¡«å……ä¸ºæˆåŠŸå€¼çš„ç±»å‹ï¼Œåœ¨è¿™é‡Œæ˜¯ä¸€ä¸ª<code>std::fs::File</code>ç±»å‹çš„æ–‡ä»¶å¥æŸ„ï¼Œ<code>E</code>åˆ™æ˜¯<code>std::io::Error</code>ç±»å‹ã€‚è¿™æ„å‘³ç€<code>File::open</code>å‡½æ•°å¯èƒ½ä¼šè¿”å›ä¸€ä¸ªæ–‡ä»¶å¥æŸ„ï¼Œå¯ä»¥ç”¨æ¥è¿›è¡Œè¯»å†™ã€‚æˆ–è€…å¯èƒ½è¿”å›ä¸€ä¸ªioé”™è¯¯ã€‚</p> <p>å› æ­¤æˆ‘ä»¬éœ€è¦ç”¨<code>match</code>è¡¨è¾¾å¼å¯¹<code>Result</code>çš„æ‰€æœ‰æƒ…å†µè¿›è¡Œè¦†ç›–ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">use</span> std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span>File<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> f <span class="token operator">=</span> File<span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token keyword">match</span> f <span class="token punctuation">{</span>
        <span class="token function">Ok</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> file<span class="token punctuation">,</span>
        <span class="token function">Err</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token string">&quot;Problem opening the file: {:?}&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="matching-on-different-errors"><a href="#matching-on-different-errors" class="header-anchor">#</a> Matching on Different Errors</h3> <p>ä¸Šé¢çš„ä»£ç ï¼Œå½“æ‰“å¼€æ–‡ä»¶å‡ºé”™æ—¶ï¼Œä¸è®ºä½•ç§é”™è¯¯éƒ½ä¼šè°ƒç”¨<code>panic!</code>å®ç„¶åé€€å‡ºç¨‹åºã€‚è€Œæˆ‘ä»¬çš„æœŸæœ›æ—¶æ ¹æ®ä¸åŒçš„é”™è¯¯ç±»å‹ï¼Œæœ‰ä¸åŒçš„å¤„ç†æ–¹æ¡ˆã€‚æ¯”å¦‚å› ä¸ºæ–‡ä»¶ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬å¸Œæœ›åˆ›å»ºæ–‡ä»¶ï¼›å¦‚æœæ˜¯å› ä¸ºæ²¡æœ‰æƒé™ï¼Œåˆ™è°ƒç”¨<code>panic!</code>å®é€€å‡ºç¨‹åºã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">use</span> std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span>File<span class="token punctuation">;</span>
<span class="token keyword">use</span> std<span class="token punctuation">::</span>io<span class="token punctuation">::</span>ErrorKind<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> f <span class="token operator">=</span> File<span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token keyword">match</span> f <span class="token punctuation">{</span>
        <span class="token function">Ok</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> file<span class="token punctuation">,</span>
        <span class="token function">Err</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">match</span> error<span class="token punctuation">.</span><span class="token function">kind</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            ErrorKind<span class="token punctuation">::</span>NotFound <span class="token operator">=&gt;</span> <span class="token keyword">match</span> File<span class="token punctuation">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">Ok</span><span class="token punctuation">(</span>fc<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> fc<span class="token punctuation">,</span>
                <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token string">&quot;Problem creating the file: {:?}&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            other_error <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token string">&quot;Problem opening the file: {:?}&quot;</span><span class="token punctuation">,</span> other_error<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><code>File::open</code>å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªæ ‡å‡†åº“æä¾›çš„<code>io::Error</code>ç±»å‹çš„é”™è¯¯ã€‚è¿™ä¸ªç±»å‹ä¸Šæœ‰ä¸€ä¸ª<code>kind</code>æ–¹æ³•ç”¨æ¥è·å–<code>io::ErrorKind</code>ç±»å‹çš„å€¼ã€‚è¿™ä¸ªç±»å‹ä¹Ÿç”±æ ‡å‡†åº“æä¾›ï¼Œæšä¸¾äº†ä¸€äº›ioæ“ä½œå¯èƒ½å‡ºç°çš„é”™è¯¯ç±»å‹ã€‚æˆ‘ä»¬æƒ³è¦åœ¨<code>ErrorKind::NotFound</code>é”™è¯¯ç±»å‹å‡ºç°æ—¶ï¼Œåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚ç”±äº<code>File::create</code>æ–¹æ³•ä¹Ÿæœ‰å¯èƒ½å¤±è´¥ï¼Œæ‰€ä»¥ä¹Ÿéœ€è¦ç”¨<code>match</code>è¡¨è¾¾å¼è¦†ç›–å¯èƒ½å‡ºç°çš„æƒ…å†µã€‚</p> <p>ä½†æ˜¯è¿™é‡Œå‡ºç°äº†å¤ªå¤šçš„<code>match</code>è¡¨è¾¾å¼åµŒå¥—ã€‚åé¢ä¼šä»‹ç»*é—­åŒ…ï¼ˆclosureï¼‰*çš„ç”¨æ³•ã€‚</p> <h3 id="shortcuts-for-panic-on-error-unwrap-and-expect"><a href="#shortcuts-for-panic-on-error-unwrap-and-expect" class="header-anchor">#</a> Shortcuts for Panic on Error: <code>unwrap</code> and <code>expect</code></h3> <p><code>match</code>è¡¨è¾¾å¼èƒ½å¤Ÿæ»¡è¶³éœ€æ±‚ã€‚ä½†æ˜¯å¤ªå¤šçš„<code>match</code>æ˜¾å¾—å¤ªå•°å—¦ï¼Œè¡¨æ„ä¹Ÿä¸å¤Ÿæ¸…æ™°ã€‚<code>Result&lt;T, E&gt;</code>ä¸Šæœ‰è®¸å¤šå·¥å…·å‡½æ•°ï¼Œå…¶ä¸­ä¸€ä¸ªå«åš<code>unwrap</code>çš„å‡½æ•°å¯ä»¥ä½œä¸º<code>match</code>è¡¨è¾¾å¼çš„è¯­æ³•ç³–ä½¿ç”¨ã€‚å¦‚æœæ˜¯æˆåŠŸçŠ¶æ€ï¼Œ<code>unwrap</code>æ–¹æ³•ä¼šè¿”å›å€¼ï¼›å¦‚æœæ˜¯å¤±è´¥çŠ¶æ€ï¼Œ<code>unwrap</code>ä¼šè°ƒç”¨<code>panic!</code>å®ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">use</span> std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span>File<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> f <span class="token operator">=</span> File<span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>å¦å¤–ä¸€ä¸ª<code>expect</code>æ–¹æ³•ï¼Œä½œç”¨å’Œ<code>unwrap</code>ä¸€æ ·ï¼Œä½†æ˜¯å¯ä»¥è®©æˆ‘ä»¬æŒ‡å®šé”™è¯¯è¾“å‡ºä¿¡æ¯ã€‚å¯ä»¥è¡¨è¾¾æˆ‘ä»¬æƒ³è¡¨è¾¾çš„é”™è¯¯ä¿¡æ¯ï¼Œåœ¨é”™è¯¯è¿½è¸ªæ—¶ä¹Ÿæ¯”è¾ƒå®¹æ˜“ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">use</span> std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span>File<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> f <span class="token operator">=</span> File<span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to open hello.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="propagating-errors"><a href="#propagating-errors" class="header-anchor">#</a> Propagating Errors</h3> <p>å½“ä½ å®ç°ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œå®ƒçš„å®ç°å¯èƒ½ä¼šæŠ›å‡ºæŸäº›é”™è¯¯ï¼Œä¸å…¶åœ¨ä½ çš„å‡½æ•°ä¸­æ•è·è¿™ä¸ªé”™è¯¯ï¼Œä¸å¦‚æŠŠè¿™ä¸ªé”™è¯¯ä¼ é€’ç»™è°ƒç”¨è€…ï¼Œå¥½è®©è°ƒç”¨è€…å†³å®šå¦‚ä½•å¤„ç†è¿™ä¸ªé”™è¯¯ã€‚è¿™ä¸ªè¢«ç§°ä¸ºé”™è¯¯çš„<em>ä¼ é€’ï¼ˆpropgationï¼‰</em>ï¼Œè¿™ç»™äº†è°ƒç”¨è€…æ›´å¤šçš„æ§åˆ¶æƒï¼Œå®ƒå†…éƒ¨ä¹Ÿè®¸æœ‰æ›´å®Œå–„çš„ä¿¡æ¯å’Œé€»è¾‘æ¥å¤„ç†é”™è¯¯ã€‚</p> <p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦å†™ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­è¯»å–ä¸€äº›å†…å®¹ï¼Œå¦‚æœè¯»å–é”™è¯¯ï¼Œå°†è¿™ä¸ªé”™è¯¯æŠ›ç»™è°ƒç”¨è€…ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">use</span> std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span>File<span class="token punctuation">;</span>
<span class="token keyword">use</span> std<span class="token punctuation">::</span>io<span class="token punctuation">;</span>
<span class="token keyword">use</span> std<span class="token punctuation">::</span>io<span class="token punctuation">::</span>Read<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function">read_username_from_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> Result<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> io<span class="token punctuation">::</span>Error<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> f <span class="token operator">=</span> File<span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> f <span class="token operator">=</span> <span class="token keyword">match</span> f <span class="token punctuation">{</span>
        <span class="token function">Ok</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> file<span class="token punctuation">,</span>
        <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">return</span> <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">match</span> f<span class="token punctuation">.</span><span class="token function">read_to_string</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">Ok</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">Ok</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h4 id="a-shortcut-for-propagating-errors-the-operator"><a href="#a-shortcut-for-propagating-errors-the-operator" class="header-anchor">#</a> A Shortcut for Propagating Errors: the ? Operator</h4> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">use</span> std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span>File<span class="token punctuation">;</span>
<span class="token keyword">use</span> std<span class="token punctuation">::</span>io<span class="token punctuation">;</span>
<span class="token keyword">use</span> std<span class="token punctuation">::</span>io<span class="token punctuation">::</span>Read<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function">read_username_from_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> Result<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> io<span class="token punctuation">::</span>Error<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> f <span class="token operator">=</span> File<span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    f<span class="token punctuation">.</span><span class="token function">read_to_string</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token function">Ok</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>?</code>æ“ä½œç¬¦è·Ÿåœ¨<code>Result&lt;T, E&gt;</code>ç±»å‹ä¹‹åï¼Œå½“<code>Result</code>å€¼æ˜¯<code>Ok</code>æ—¶ï¼Œå®ƒçš„å€¼ä¼šä½œä¸ºè¡¨è¾¾å¼çš„å€¼è¿”å›ï¼›å½“å€¼æ˜¯<code>Err</code>æ—¶ï¼Œä¼šå°†è¿™ä¸ªé”™è¯¯ä½œä¸ºæ•´ä¸ªå‡½æ•°çš„è¿”å›å€¼æŠ›å‡ºã€‚</p> <p><code>match</code>è¡¨è¾¾å¼å’Œ<code>?</code>æ“ä½œç¬¦è¿˜æœ‰ä¸€ç‚¹ä¸åŒï¼š<code>?</code>æ“ä½œç¬¦æŠ›å‡ºçš„é”™è¯¯ä¼šç»è¿‡ä¸€ä¸ªç”±æ ‡å‡†åº“<code>From</code>traitæä¾›çš„ï¼Œåç§°ä¸º<code>from</code>çš„å‡½æ•°å¤„ç†ï¼Œå®ƒå°†åŸå§‹çš„é”™è¯¯ç±»å‹è½¬æ¢æˆæˆ‘ä»¬å½“å‰å‡½æ•°å£°æ˜ä¸­å®šä¹‰çš„é”™è¯¯ç±»å‹ã€‚åªè¦é”™è¯¯ç±»å‹å®ç°äº†<code>from</code>æ–¹æ³•ï¼Œ<code>?</code>æ“ä½œç¬¦å°±ä¼šè°ƒç”¨å®ƒæ¥è¿›è¡Œé”™è¯¯ç±»å‹è½¬æ¢ã€‚</p> <p><code>?</code>æ“ä½œç¬¦ä½¿å‡½æ•°ä½“æ›´åŠ ç®€æ´ï¼Œä¸Šé¢è¿™ä¸ªä¾‹å­è¿˜å¯ä»¥æ›´åŠ ç®€æ´ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">use</span> std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span>File<span class="token punctuation">;</span>
<span class="token keyword">use</span> std<span class="token punctuation">::</span>io<span class="token punctuation">;</span>
<span class="token keyword">use</span> std<span class="token punctuation">::</span>io<span class="token punctuation">::</span>Read<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function">read_username_from_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> Result<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> io<span class="token punctuation">::</span>Error<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    File<span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">read_to_string</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token function">Ok</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.6f46cf57.js" defer></script><script src="/assets/js/2.49ce1412.js" defer></script><script src="/assets/js/12.14d347b9.js" defer></script>
  </body>
</html>
